import{a as p,u as j,g,r as f,j as e,S as N,c as b,L as y,X as v,A as w}from"./main-ConWnhM4.js";import{f as A}from"./leadership-api-actions-DTKWlp3o.js";import"./preload-helper-BfFHrpNk.js";function E(){const h=p(),x=j(g),[l,u]=f.useState();f.useEffect(()=>{l||h(A({onSuccess:s=>u(s)}))},[l,h]);const m=f.useMemo(()=>{if(l){const s={};return l.marks.forEach(t=>{s[t.studentId]||(s[t.studentId]=[]),t.score1&&s[t.studentId].push(t.score1),t.score2&&s[t.studentId].push(t.score2)}),l.users.map(t=>{var n,c;const r=l.grades.find(({id:a})=>{var i;return a===(((i=t.student)==null?void 0:i.gradeId)||0)}),d=(n=s[t.id])==null?void 0:n.reduce((a,i)=>i===4||i==5?a+i:i===3?a-i:i===2?a-5:0,0);return{id:t.id,avatar:t.avatarThumb,gradeId:((c=t.student)==null?void 0:c.gradeId)||"",name:`${t.surname} ${t.name} ${t.patronymic??""}`,grade:r?`${r==null?void 0:r.level} "${r==null?void 0:r.group}"`:"",score:d}}).sort((t,r)=>{const d=t.score,n=r.score,c=d==null,a=n==null;return c&&!a?1:!c&&a?-1:c&&a?0:n-d})}},[l]);return!l||!m||!x?e.jsx(N,{className:"w-4 h-4 mt-4"}):e.jsxs("main",{className:"py-2 flex flex-col gap-2 pb-40",children:[e.jsx("h1",{className:"title px-3",children:"Мой класс"}),e.jsxs("table",{className:"flex flex-col bg-white shadow rounded border",children:[e.jsx("thead",{className:"sticky top-0 z-10 flex bg-[#efefef] font-medium shadow py-1 rounded-t",children:e.jsxs("tr",{className:"grid grid-cols-[40px_1fr_8fr_2fr_2fr] w-full",children:[e.jsx("th",{children:"№"}),e.jsx("th",{children:"Фото"}),e.jsx("th",{className:"text-start",children:"ФИО"}),e.jsx("th",{children:"Класс"}),e.jsx("th",{children:"Ранг"})]})}),e.jsx("tbody",{className:"relative z-0",children:m.map((s,o)=>e.jsxs("tr",{className:b("grid grid-cols-[40px_1fr_8fr_2fr_2fr] w-full py-1",o%2&&"bg-gray-50"),children:[e.jsxs("td",{className:"flex items-center justify-center",children:[o+1,"."]}),e.jsx("td",{className:"flex items-center justify-center",children:e.jsx("div",{className:"relative z-10 w-12 lg:mb-0",children:e.jsx("div",{children:e.jsx("img",{className:"block w-full h-full rounded-full object-cover border-[2px] border-white",src:s.avatar||"/images/avatar.png",width:144,height:144,alt:s.name})})})}),e.jsx("td",{className:"flex items-center text-lg",children:e.jsx(y,{className:"text-blue-600",to:v(w.Users.Show,{id:s.id}),children:s.name})}),e.jsx("td",{className:"flex items-center justify-center text-lg font-medium",children:s.grade}),e.jsx("td",{className:"flex items-center justify-center text-xl font-semibold text-blue-700",children:s.score})]},s.id))})]})]})}export{E as default};
