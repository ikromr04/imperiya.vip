import{u as N,r as o,a as u,M as y,D as M,j as s,S,p as t,c as j}from"./main-D1X-5qeh.js";import{I as c}from"./icons-Cwm3zsc5.js";import{g as Y,c as b}from"./index-Y5BpZlJY.js";import{H as k,L as D}from"./lesson-hour-DTH_J5YM.js";import{S as v}from"./student-lessons-item-CPDh2JQs.js";import{g as z}from"./subjects-selector-H4IosHxK.js";import{g as L}from"./users-selector-Cpbhop2B.js";function R(){const i=N(),[m,d]=o.useState(null),[x,f]=o.useState(0),a=Y(x),p=o.useRef(null),r=u(z),w={},l=u(L);o.useEffect(()=>{!r.data&&!r.isFetching&&i(y()),!l.data&&!l.isFetching&&i(M())},[i,m,r.data,r.isFetching,l.data,l.isFetching,x]);const h=e=>{if(p.current){const{scrollLeft:n}=e.currentTarget;p.current.querySelectorAll(".sync-scroll").forEach(g=>{g.scrollLeft=n})}};return!m||!r.data||!w.data||!l.data?s.jsx(S,{className:"w-8 h-8"}):s.jsxs("div",{className:"rounded-md shadow border pb-1 bg-[linear-gradient(to_bottom,white_0%,white_50%,#f3f4f6_50%,#f3f4f6_100%)] max-w-full",children:[s.jsxs("table",{ref:p,className:"flex flex-col w-full",children:[s.jsx("caption",{className:"text-left p-2 pl-4 border-b",children:s.jsxs("div",{className:"flex items-baseline gap-1 text-blue-700",children:[s.jsx(c.calendar,{className:"relative top-[1px]",height:16}),b(t(a[0]).format("MMMM")),t(a[0]).format("M")!==t(a[5]).format("M")&&` - ${b(t(a[5]).format("MMMM"))}`]})}),s.jsx("thead",{className:"sticky top-0 z-20 bg-gray-100 shadow overflow-x-auto no-scrollbar sync-scroll",onScroll:h,children:s.jsxs("tr",{children:[s.jsx("th",{className:"min-w-7 w-7 max-w-7 sticky left-0 z-10 bg-gray-100"}),s.jsx("th",{className:"min-w-20 w-20 max-w-20"}),a.map(e=>s.jsx("th",{className:j("p-2 min-w-[260px] w-[260px] max-w-[260px] text-center",t(e).format("YYYY-MM-DD")===t().format("YYYY-MM-DD")&&"bg-green-50"),children:b(e.format("dddd - DD"))},t(e).format()))]})}),s.jsx("tbody",{className:"overflow-x-auto no-scrollbar sync-scroll bg-white",onScroll:h,children:Object.keys(k).map(e=>s.jsxs("tr",{className:"min-h-[53px] h-[53px] max-h-[53px] border-b",children:[s.jsx("td",{className:"min-w-7 w-7 max-w-7 text-center font-semibold sticky left-0 z-10 bg-white",children:s.jsx("div",{className:"absolute left-0 top-0 w-full h-full border-r border-l flex justify-center items-center",children:e})}),s.jsx("td",{className:"min-w-20 w-20 max-w-20 text-sm",children:s.jsx(D,{hour:+e})}),a.map(n=>s.jsx("td",{className:j("relative z-0 p-2 border-l min-w-[260px] w-[260px] max-w-[260px]",t(n).format("YYYY-MM-DD")===t().format("YYYY-MM-DD")?"bg-green-50":"bg-white"),children:r.data&&l.data&&s.jsx(v,{date:n,hour:Number(e),subjects:r.data,users:l.data,lessons:m})},t(n).format()))]},e))}),s.jsx("tfoot",{className:"sticky bottom-[48px] z-10 overflow-x-auto bg-white styled-scrollbar mb-[-1px] sync-scroll",onScroll:h,children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-0 border-b min-w-10 w-10"}),s.jsx("th",{className:"p-0 border-b min-w-[91px]"}),a.map(e=>s.jsx("th",{className:"p-0 min-w-[260px] w-[260px] max-w-[260px] text-center border-b"},t(e).format()))]})})]}),s.jsx("div",{className:"sticky bottom-0 z-10 p-2 border-t bg-gray-100",children:s.jsxs("div",{className:"flex w-max ml-auto gap-4",children:[s.jsxs("button",{className:"flex justify-center items-center gap-x-2 h-8 border-transparent rounded-md border transform disabled:opacity-50 disabled:pointer-events-none",onClick:()=>{f(e=>e-1),d(null)},children:[s.jsx(c.previous,{width:7}),s.jsx("span",{className:"sr-only md:not-sr-only",children:"Предыдущая неделя"})]}),x!==0&&s.jsxs("button",{className:"flex justify-center items-center h-8 rounded-md",onClick:()=>{f(0),d(null)},children:[s.jsx(c.currentWeek,{width:16,height:16}),s.jsx("span",{className:"sr-only",children:"Текущая неделя"})]}),s.jsxs("button",{className:"flex justify-center items-center gap-x-2 h-8 border-transparent rounded-md border transform disabled:opacity-50 disabled:pointer-events-none",onClick:()=>{f(e=>e+1),d(null)},children:[s.jsx("span",{className:"sr-only md:not-sr-only",children:"Следующая неделя"}),s.jsx(c.next,{width:7})]})]})})]})}export{R as S};
