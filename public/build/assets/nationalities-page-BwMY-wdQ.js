import{u,j as s,G as S,y as m,H as v,I as D,a as f,r as d,h as F,i as w,S as E}from"./main-DTCJiQsq.js";import{D as T}from"./data-table-ChgBBS8p.js";import{B as o}from"./button-ZbyXFrBi.js";import{M as C}from"./modal-Bd5XVz8d.js";import{g as k,a as A}from"./nationalities-selector-C_DFCmFp.js";import{T as N}from"./text-field-DtssmZdu.js";import{F as j,a as p}from"./formik.esm-DmaS9LwQ.js";import{c as y,a as g}from"./index.esm-COLkK52-.js";import"./preload-helper-DPi8upcZ.js";import"./icons-B2aTwrz9.js";import"./use-dropdown-BewGSdNb.js";import"./index-D-ibmixo.js";import"./cleanable-D3GteXwV.js";import"./index.browser-OxPLOBIU.js";const O=y().shape({name:g().required("Обязательное поле.")});function V({dto:l,setDTO:a}){const t=u(),r={name:l.name},n=async(e,c)=>{c.setSubmitting(!0),await t(S({name:e.name,onSuccess:()=>{m.success("Национальность успешно добавлена."),a(null)},onValidationError:i=>c.setErrors({...i.errors}),onFail:i=>m.success(i)})),c.setSubmitting(!1)};return s.jsx(j,{initialValues:r,validationSchema:O,onSubmit:n,children:({isSubmitting:e})=>s.jsxs(p,{children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[s.jsx("h3",{className:"title",children:"Добавление национальности"}),s.jsx(o,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>a(null),children:s.jsx("span",{className:"sr-only",children:"Отмена"})})]}),s.jsx(N,{className:"mb-4",name:"name",label:"Национальность",required:!0}),s.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:s.jsx(o,{className:"justify-center min-w-[92px]",type:"submit",icon:"edit",disabled:e,loading:e,variant:"success",children:"Добавить"})})]})})}const q=y().shape({name:g().required("Обязательное поле.")});function $({dto:l,setDTO:a}){const t=u(),r={id:l.id,name:l.name},n=async(e,c)=>{c.setSubmitting(!0),await t(v({dto:e,onSuccess:()=>{m.success("Национальность успешно обновлена."),a(null)},onValidationError:i=>c.setErrors({...i.errors}),onFail:i=>m.success(i)})),c.setSubmitting(!1)};return s.jsx(j,{initialValues:r,validationSchema:q,onSubmit:n,children:({isSubmitting:e})=>s.jsxs(p,{children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[s.jsx("h3",{className:"title",children:"Редактирование"}),s.jsx(o,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>a(null),children:s.jsx("span",{className:"sr-only",children:"Отмена"})})]}),s.jsx(N,{className:"mb-4",name:"name",label:"Национальность",required:!0}),s.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:s.jsx(o,{className:"justify-center min-w-[92px]",type:"submit",icon:"edit",disabled:e,loading:e,variant:"success",children:"Сохранить"})})]})})}function z({dto:l,setDTO:a}){const t=u(),r=async(n,e)=>{e.setSubmitting(!0),await t(D({id:l,onSuccess:()=>{m.success("Национальность успешно удалена."),a(null)}})),e.setSubmitting(!1)};return s.jsx(j,{initialValues:{},onSubmit:r,children:({isSubmitting:n})=>s.jsxs(p,{children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[s.jsx("h3",{className:"title",children:"Удалить национальность"}),s.jsx(o,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>a(null),children:s.jsx("span",{className:"sr-only",children:"Отмена"})})]}),s.jsx("p",{children:"Вы уверены что хотите удалить?"}),s.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:s.jsx(o,{className:"justify-center min-w-[92px]",type:"submit",icon:"edit",disabled:n,loading:n,variant:"success",children:"Удалить"})})]})})}function Y(){const l=u(),a=f(k),t=f(A),[r,n]=d.useState(null),[e,c]=d.useState(null),[i,h]=d.useState(null);d.useEffect(()=>{a===F.Idle&&l(w())},[l,a]);const b=[{id:"name",accessorKey:"name",header:"Название",size:1686},{id:"actions",accessorKey:"actions",header:"Действия",enableSorting:!1,size:120,cell:({row:x})=>s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(o,{icon:"edit",variant:"warning",onClick:()=>c({id:x.original.id,name:x.original.name}),children:s.jsx("span",{className:"sr-only",children:"Редактировать"})}),s.jsx(o,{icon:"delete",variant:"danger",onClick:()=>h(x.original.id),children:s.jsx("span",{className:"sr-only",children:"Удалить"})})]})}];return s.jsxs(s.Fragment,{children:[s.jsxs("main",{className:"py-2",children:[s.jsxs("h1",{className:"title mb-1 px-3",children:["Национальности (",t==null?void 0:t.length,")"]}),t?s.jsx(T,{data:t,columns:b,sortingState:[{id:"name",desc:!1}],columnPinningState:{right:["actions"]},actions:s.jsx(o,{icon:"add",variant:"success",onClick:()=>n({name:""}),children:s.jsx("span",{className:"sr-only md:not-sr-only",children:"Добавить"})})}):s.jsx(E,{className:"w-8 h-8"})]}),s.jsxs(C,{isOpen:!!(r||e||i),children:[r&&s.jsx(V,{dto:r,setDTO:n}),e&&s.jsx($,{dto:e,setDTO:c}),i&&s.jsx(z,{dto:i,setDTO:h})]})]})}export{Y as default};
