import{a as p,f as j,r as h,j as e,c as g}from"./main-ConWnhM4.js";import{f as b}from"./leadership-api-actions-DTKWlp3o.js";import{L as N}from"./layout-D9slw4ew.js";import"./preload-helper-BfFHrpNk.js";import"./users-selector-BQg7DqyW.js";import"./button-CKVFwUw_.js";import"./icons-DmwnT1ee.js";import"./users-DUqPc0QS.js";import"./grades-selector-C8NliX7u.js";import"./nationalities-selector-DDXY-U9Y.js";import"./description-list-DU_AlQEj.js";function P(){const u=p(),o=j(),[n,x]=h.useState();h.useEffect(()=>{!n&&o.id&&u(b({studentId:+o.id,onSuccess:s=>x(s)}))},[n,u,o.id]);const f=h.useMemo(()=>{if(n){const s={};return n.marks.forEach(t=>{s[t.studentId]||(s[t.studentId]=[]),t.score1&&s[t.studentId].push(t.score1),t.score2&&s[t.studentId].push(t.score2)}),n.users.map(t=>{var d,c;const r=n.grades.find(({id:i})=>{var a;return i===(((a=t.student)==null?void 0:a.gradeId)||0)}),l=(d=s[t.id])==null?void 0:d.reduce((i,a)=>a===4||a==5?i+a:a===3?i-a:a===2?i-5:0,0);return{id:t.id,avatar:t.avatarThumb,gradeId:((c=t.student)==null?void 0:c.gradeId)||"",name:`${t.surname} ${t.name} ${t.patronymic??""}`,grade:r?`${r==null?void 0:r.level} "${r==null?void 0:r.group}"`:"",score:l}}).sort((t,r)=>{const l=t.score,d=r.score,c=l==null,i=d==null;return c&&!i?1:!c&&i?-1:c&&i?0:d-l})}},[n]);return e.jsx(N,{children:e.jsxs("table",{className:"flex flex-col bg-white shadow rounded border",children:[e.jsx("thead",{className:"sticky top-0 z-10 flex bg-[#efefef] font-medium shadow py-1 rounded-t",children:e.jsxs("tr",{className:"grid grid-cols-[40px_1fr_8fr_2fr_2fr] w-full",children:[e.jsx("th",{children:"№"}),e.jsx("th",{children:"Фото"}),e.jsx("th",{className:"text-start",children:"ФИО"}),e.jsx("th",{children:"Класс"}),e.jsx("th",{children:"Ранг"})]})}),e.jsx("tbody",{className:"relative z-0",children:f==null?void 0:f.map((s,m)=>e.jsxs("tr",{className:g("grid grid-cols-[40px_1fr_8fr_2fr_2fr] w-full py-1",m%2&&"bg-gray-50"),children:[e.jsxs("td",{className:"flex items-center justify-center",children:[m+1,"."]}),e.jsx("td",{className:"flex items-center justify-center",children:e.jsx("div",{className:"relative z-10 w-12 lg:mb-0",children:e.jsx("div",{children:e.jsx("img",{className:"block w-full h-full rounded-full object-cover border-[2px] border-white",src:s.avatar||"/images/avatar.png",width:144,height:144,alt:s.name})})})}),e.jsx("td",{className:"flex items-center",children:s.name}),e.jsx("td",{className:"flex items-center justify-center text-lg font-medium",children:s.grade}),e.jsx("td",{className:"flex items-center justify-center text-xl font-semibold text-blue-700",children:s.score})]},s.id))})]})})}export{P as default};
