import{j as e,c as N,r as L,u as te,a as $,h as P,x as ae,m as ne,i as le,k as ie,q as K,L as W,v as V,A as U,S as re,a4 as oe,y as de}from"./main-Dw1yuUwf.js";import{g as ce,a as me}from"./users-selector-DnYDMv9p.js";import{I as y}from"./icons-D1xy210t.js";import{S as q,a as ue,b as J,R as ge}from"./users-DUqPc0QS.js";import{g as he,a as xe}from"./grades-selector-7JnXScQQ.js";import{n as fe}from"./index.browser-OxPLOBIU.js";import{e as pe,f as be}from"./users-CkLrZEBN.js";import{u as Y}from"./use-dropdown-DWskSKMx.js";import{B as _}from"./button-CZ8BjX0E.js";import{g as je,a as ye}from"./nationalities-selector-3uynH7pm.js";import{g as Ne,a as ve}from"./professions-selector-DtbhPhXB.js";import{C as we}from"./copy-button-DcslLt_D.js";import{f as O,u as Ce,g as ke,a as Se,b as Ie,c as Fe}from"./index-B2E4MO7_.js";import"./preload-helper-DPi8upcZ.js";function X({label:n,required:h,...p}){if(n)return e.jsxs("label",{className:"relative z-0 rounded flex max-w-max text-sm text-gray-500 ml-2",...p,children:[n,h&&e.jsx("span",{className:"text-error transform scale-[1.4] translate-y-[10%] translate-x-[16%]",children:"*"})]})}function ze({className:n,...h}){return e.jsx("input",{...h,className:N("flex grow bg-gray-50 min-w-0 border border-gray-200 rounded h-8 px-4 leading-none text-base focus:outline-none hover:bg-gray-100 focus:border-primary focus:bg-gray-100",n)})}function Z({className:n,onClean:h}){return e.jsxs("button",{className:N(n,"flex items-center justify-center h-full w-8 transform -translate-y-1/2"),type:"button",onClick:()=>h&&h(""),children:[e.jsx(y.close,{width:12}),e.jsx("span",{className:"sr-only",children:"Очистить поле"})]})}function Ae({element:n}){if(n)return e.jsx("div",{className:"absolute right-[1px] top-[1px] rounded-r-[3px] transform w-[30px] h-[30px] flex justify-center items-center",children:n})}function De({element:n}){if(n)return e.jsx("div",{className:"absolute left-[1px] top-[1px] rounded-r-[3px] transform w-[30px] h-[30px] flex justify-center items-center",children:n})}function M({className:n,label:h,value:p,onChange:C,required:k,before:v,after:x,...u}){const m=fe();return e.jsxs("div",{className:N(n,"flex flex-col"),children:[e.jsx(X,{required:k,label:h,htmlFor:m}),e.jsxs("div",{className:"relative flex",children:[e.jsx(De,{element:v}),e.jsx(ze,{className:N(x?"pr-16":"pr-8",v&&"pl-8"),id:m,value:p,...u,onChange:i=>C&&C(i.target.value)}),p&&e.jsx(Z,{className:N("absolute top-1/2",x?"right-8":"right-0"),onClean:()=>C&&C("")}),e.jsx(Ae,{element:x})]})]})}function T({className:n,inputClass:h,value:p,onChange:C,options:k,label:v,placeholder:x}){const u=L.useId(),{ref:m,menuRef:i,isOpen:o,setIsOpen:I}=Y(),D=()=>{var S;return p?(S=k.find(z=>z.value===p))==null?void 0:S.label:e.jsx("span",{className:"text-[#a8a3b7]",children:x})};return e.jsxs("div",{ref:m,className:N(n,"relative flex flex-col"),children:[e.jsx(X,{label:v,htmlFor:u}),e.jsxs("div",{className:"relative flex",children:[e.jsx("button",{className:N("flex items-center min-h-8 grow bg-gray-50 min-w-0 border border-gray-200 rounded pl-4 pr-8 leading-none text-base focus:outline-none hover:bg-gray-100 focus:border-primary focus:bg-gray-100",h),id:u,type:"button",onClick:S=>!S.target.classList.contains("remove-selection")&&I(!o),children:D()}),p&&e.jsx(Z,{className:N("absolute right-0 top-1/2"),onClean:()=>C("")})]}),e.jsx("div",{ref:i,className:N("absolute top-[calc(100%+4px)] right-0 z-10 border rounded-md pb-1 bg-white shadow-sm text-sm min-w-max w-full text-gray-500",o?"visible opacity-100":"invisible opacity-0"),children:e.jsx("ul",{className:"max-h-56 overflow-y-auto scrollbar-y",children:k.map(S=>e.jsx("li",{children:e.jsx("button",{className:"flex w-full items-center h-8 transition-all duration-150 hover:bg-green-50 px-3",type:"button",onClick:()=>{C(S.value),I(!1)},children:S.label})},S.value))})})]})}function Re({header:n,columnPinning:h,setColumnPinning:p,setColumnVisibility:C}){var i,o,I,D,S,z,s,t;const{ref:k,isOpen:v,setIsOpen:x,menuRef:u}=Y(),m=async()=>{if(k.current&&u.current){await x(!v);const a=k.current.getBoundingClientRect();u.current.style.top=`${a.top+a.height+12}px`,u.current.style.left=`${a.left+a.width}px`;const l=u.current.getBoundingClientRect();l.right>window.innerWidth&&(u.current.style.transform=`translateX(-${l.right-window.innerWidth+32}px)`)}};return e.jsxs("div",{ref:k,className:"relative ml-auto column-filter",children:[e.jsx("button",{className:N("flex md:hidden justify-center items-center min-w-6 min-h-6 rounded-full bg-gray-100 hover:bg-gray-200",(i=h.left)!=null&&i.includes(n.column.id)||(o=h.right)!=null&&o.includes(n.column.id)||n.column.getCanFilter()?"flex text-error":"group-hover:flex"),onClick:m,children:e.jsx(y.moreVert,{width:3})}),e.jsxs("div",{ref:u,className:N("fixed top-full z-30 min-w-max flex-col py-1 bg-white rounded border shadow transform font-normal",v?"flex":"hidden"),onClick:a=>!a.target.closest(".column-filter-header")&&x(!1),children:[e.jsxs("div",{className:"flex flex-col column-filter-header px-3 py-1",children:[e.jsx("h3",{className:"text-sm leading-none text-gray-400 mb-1",children:O(n.column.columnDef.header,n.getContext())}),(D=(I=n.column.columnDef.meta)==null?void 0:I.renderFilter)==null?void 0:D.call(I,n.column,x)]}),e.jsx("hr",{className:"my-1"}),!((S=h.left)!=null&&S.includes(n.column.id))&&e.jsxs("button",{className:"flex items-center gap-2 pl-3 pr-4 py-1 transition-all duration-150 hover:bg-gray-100",type:"button",onClick:()=>p(a=>{var l;return{left:a.left&&(a.left.includes(n.column.id)?[...a.left]:[...a.left,n.column.id]),right:(l=a.right)==null?void 0:l.filter(d=>d!==n.column.id)}}),children:[e.jsx("span",{className:"flex items-center justify-center w-4 h-4",children:e.jsx(y.keep,{className:"transform rotate-[30deg]",width:10})}),"Закрепить слева"]}),!((z=h.right)!=null&&z.includes(n.column.id))&&e.jsxs("button",{className:"flex items-center gap-2 pl-3 pr-4 py-1 transition-all duration-150 hover:bg-gray-100",type:"button",onClick:()=>p(a=>{var l;return{left:(l=a.left)==null?void 0:l.filter(d=>d!==n.column.id),right:a.right&&(a.right.includes(n.column.id)?[...a.right]:[...a.right,n.column.id])}}),children:[e.jsx("span",{className:"flex items-center justify-center w-4 h-4",children:e.jsx(y.keep,{className:"transform -rotate-[30deg]",width:10})}),"Закрепить справа"]}),(((s=h.right)==null?void 0:s.includes(n.column.id))||((t=h.left)==null?void 0:t.includes(n.column.id)))&&e.jsxs("button",{className:"flex items-center gap-2 pl-3 pr-4 py-1 transition-all duration-150 hover:bg-gray-100",type:"button",onClick:()=>p(a=>{var l,d;return{left:(l=a.left)==null?void 0:l.filter(g=>g!==n.column.id),right:(d=a.right)==null?void 0:d.filter(g=>g!==n.column.id)}}),children:[e.jsx("span",{className:"flex items-center justify-center w-4 h-4",children:e.jsx(y.keep,{className:"opacity-0",width:10})}),"Открепить"]}),e.jsx("hr",{className:"my-1"}),e.jsxs("button",{className:"flex items-center gap-2 pl-3 pr-4 py-1 transition-all duration-150 hover:bg-gray-100",type:"button",onClick:()=>C(a=>({...a,[n.column.id]:!1})),children:[e.jsx("span",{className:"flex items-center justify-center w-4 h-4",children:e.jsx(y.visibilityOff,{width:16})}),"Скрыть столбец"]})]})]})}function $e({table:n,columnVisibility:h,setColumnVisibility:p}){const{ref:C,isOpen:k,setIsOpen:v}=Y(),x=n.getAllColumns().map(m=>({id:m.columnDef.id,header:m.columnDef.header})),u=m=>i=>{i.target.checked?p(o=>({...o,[m]:!0})):p(o=>({...o,[m]:!1}))};return e.jsxs("div",{ref:C,className:"relative z-30",children:[e.jsxs("button",{className:"flex items-center gap-2 h-7 px-1 text-blue-700",type:"button",onClick:()=>v(!k),children:[e.jsx(y.viewColumn,{width:16}),e.jsx("span",{className:"sr-only md:not-sr-only",children:"Столбцы"})]}),e.jsx("div",{className:N("absolute left-0 top-full bg-white py-1 border rounded shadow max-h-[240px] overflow-y-auto overflow-x-hidden styled-scrollbar",k?"visible opacity-100":"invisible opacity-0"),children:x.map(m=>e.jsxs("label",{className:"flex items-center gap-2 min-w-max pl-3 pr-5 h-8 transition-all duration-150 hover:bg-gray-100 cursor-pointer",children:[e.jsx("input",{type:"checkbox",onChange:u(m.id),checked:h[m.id]===void 0?!0:h[m.id]}),m.header]},m.id))})]})}const Le=16,Me=[],Te={},Ee={left:[],right:[]};function Pe({data:n,columns:h,pageSize:p=Le,sortingState:C=Me,visibilityState:k=Te,columnPinningState:v=Ee,actions:x,onExport:u,searchValue:m,onSearchInput:i}){const[o,I]=L.useState(""),[D,S]=L.useState({pageIndex:0,pageSize:p}),[z,s]=L.useState(C),[t,a]=L.useState(k),[l,d]=L.useState(v),g=Ce({data:n,columns:h,defaultColumn:{maxSize:Number.MAX_SAFE_INTEGER,sortDescFirst:!1,enableSorting:!0,enableColumnFilter:!1},getCoreRowModel:Fe(),getSortedRowModel:Ie(),getFilteredRowModel:Se(),getPaginationRowModel:ke(),state:{sorting:z,globalFilter:o,columnVisibility:t,pagination:D,columnPinning:l},onSortingChange:s,onGlobalFilterChange:I,onColumnVisibilityChange:a,onPaginationChange:S,onColumnPinningChange:d}),j=g.getPageCount(),b=g.getState().pagination.pageIndex+1,Q=()=>{const c=[];if(j<=7)for(let f=1;f<=j;f++)c.push(f);else{c.push(1),b>4&&c.push("...");const f=Math.max(2,b-2),w=Math.min(j-1,b+2);for(let F=f;F<=w;F++)c.push(F);b<j-3&&c.push("..."),c.push(j)}return c},B=g.getHeaderGroups()[0].headers.map(c=>({id:c.column.id,size:c.getSize()})),G=c=>{if(l.left){const r=l.left.findIndex(w=>w===c);return r&&r<0?{}:{left:`${l.left.reduce((w,F,A)=>{var R;return A<r&&(w+=((R=B.find(E=>E.id===F))==null?void 0:R.size)||0),w},0)}px`}}return{}},H=c=>{if(l.right){const r=l.right.findIndex(w=>w===c);return r&&r<0?{}:{right:`${l.right.reduce((w,F,A)=>{var R;return A<r&&(w+=((R=B.find(E=>E.id===F))==null?void 0:R.size)||0),w},0)}px`}}return{}},ee=c=>{const r=y[c==="desc"?"arrowDownwardAlt":"arrowUpwardAlt"];return e.jsx("span",{className:N("flex justify-center items-center min-w-6 min-h-6 rounded-full hover:bg-black/5",!c&&"hidden opacity-40 group-hover:flex"),children:e.jsx(r,{width:10})})},se=c=>{i?i(c):I(c.target.value)};return e.jsxs("div",{className:"flex flex-col rounded-md shadow border bg-white overflow-scroll max-h-[calc(100vh-42px)] styled-scrollbar text-sm md:text-[16px] md:max-h-[calc(100vh-48px)]",children:[e.jsxs("div",{className:"sticky left-0 z-50 flex gap-2 p-1 border-b w-full",children:[e.jsx($e,{table:g,columnVisibility:t,setColumnVisibility:a}),e.jsxs("label",{className:"flex grow items-center gap-1 h-7 cursor-pointer text-blue-700",children:[e.jsx(y.search,{width:14}),e.jsx("input",{className:"flex cursor-pointer focus:cursor-auto grow min-w-none w-full focus:outline-none placeholder:text-inherit focus:placeholder:font-normal focus:placeholder:text-gray-400",type:"search",placeholder:"Искать",value:m||o,onInput:se})]}),e.jsxs("div",{className:"flex gap-1",children:[u&&e.jsx(_,{className:"max-h-7",icon:"fileExport",variant:"light",onClick:()=>u(n,t),children:e.jsx("span",{className:"sr-only md:not-sr-only",children:"Экспорт"})}),x]})]}),e.jsx("div",{className:"sticky top-0 z-40 shadow min-w-max",children:g.getHeaderGroups().map(c=>e.jsxs("div",{className:"flex font-semibold min-h-7",children:[e.jsx("div",{className:"flex items-center justify-center px-1 min-w-8 max-w-8 bg-gray-100 md:px-2 md:min-w-10 md:max-w-10",children:"№"}),c.headers.map(r=>{var f,w,F,A,R;return e.jsxs("div",{className:N("flex items-center text-start bg-gray-100 cursor-pointer group border-gray-200 px-1 md:px-2",((f=l.left)==null?void 0:f.includes(r.column.id))&&"sticky z-10 border-r",((w=l.right)==null?void 0:w.includes(r.column.id))&&"sticky z-10 border-l",(F=r.column.columnDef.meta)==null?void 0:F.columnClass),onClick:E=>!E.target.closest(".column-filter")&&r.column.toggleSorting(),style:{minWidth:`${r.getSize()}px`,width:`${r.getSize()}px`,maxWidth:`${r.getSize()}px`,...G(r.column.id),...H(r.column.id)},children:[(A=r.column.columnDef.meta)!=null&&A.renderHeader?(R=r.column.columnDef.meta)==null?void 0:R.renderHeader(r.column):e.jsx("span",{className:"text-start truncate select-none",children:O(r.column.columnDef.header,r.getContext())}),r.column.getCanSort()&&ee(r.column.getIsSorted()),e.jsx(Re,{header:r,columnPinning:l,setColumnPinning:d,setColumnVisibility:a})]},r.id)})]},c.id))}),e.jsx("div",{className:"min-w-max",children:g.getRowModel().rows.map((c,r)=>e.jsxs("div",{className:N("flex",r%2?"bg-gray-50":"bg-white"),children:[e.jsxs("div",{className:N("flex items-center justify-end p-1 min-w-8 max-w-8 md:p-2 md:min-w-10 md:max-w-10",r%2?"bg-gray-50":"bg-white"),children:[(b-1)*p+r+1,"."]}),c.getVisibleCells().map(f=>{var w,F,A;return e.jsx("div",{className:N("flex items-center p-1 md:p-2",r%2?"bg-gray-50":"bg-white",((w=l.left)==null?void 0:w.includes(f.column.id))&&"sticky left-0 z-10 border-r",((F=l.right)==null?void 0:F.includes(f.column.id))&&"sticky right-0 z-10 border-l",(A=f.column.columnDef.meta)==null?void 0:A.columnClass),style:{minWidth:`${f.column.getSize()}px`,width:`${f.column.getSize()}px`,maxWidth:`${f.column.getSize()}px`,...G(f.column.id),...H(f.column.id)},children:O(f.column.columnDef.cell,f.getContext())},JSON.stringify(f))})]},JSON.stringify(c.original)))}),e.jsx("div",{className:"sticky bottom-0 left-0 z-10 p-1 border-t bg-gray-100",children:e.jsxs("div",{className:"flex w-max ml-auto",children:[e.jsx("button",{className:"flex justify-center items-center h-7 w-7 border-transparent rounded-md border transform disabled:opacity-50 disabled:pointer-events-none",onClick:()=>g.previousPage(),disabled:!g.getCanPreviousPage(),children:e.jsx(y.previous,{width:7})}),Q().map((c,r)=>e.jsx("button",{className:N("flex justify-center items-center h-7 rounded-md border transform hover:font-bold",b===c?"w-10 bg-white border-gray-200 pointer-events-none":"w-8 border-transparent",c==="..."?"pointer-events-none":"disabled:opacity-50 disabled:pointer-events-none"),onClick:()=>typeof c=="number"&&g.setPageIndex(c-1),disabled:c==="...",children:c},r)),e.jsx("button",{className:"flex justify-center items-center h-7 w-7 border-transparent rounded-md border transform disabled:opacity-50 disabled:pointer-events-none",onClick:()=>g.nextPage(),disabled:!g.getCanNextPage(),children:e.jsx(y.next,{width:7})})]})})]})}function Qe(){var S,z;const n=te(),h=$(ce),p=$(he),C=$(je),k=$(Ne),v=$(me),x=$(xe),u=$(ye),m=$(ve),[i,o]=L.useState({});L.useEffect(()=>{h===P.Idle&&n(ae()),p===P.Idle&&n(ne()),C===P.Idle&&n(le()),k===P.Idle&&n(ie())},[n,p,C,k,h]);const I=(s,t)=>()=>{n(oe({id:s,dto:{blocked_at:t?K().format("YYYY-MM-DD HH:mm:ss"):null},onFail:de.error}))},D=[{id:"avatarThumb",accessorKey:"avatarThumb",header:"Фото",size:64,cell:({row:s})=>e.jsxs("span",{className:"relative z-0 flex min-w-12 max-w-12 min-h-12 max-h-12 rounded-full bg-gray-100 overflow-hidden",children:[s.original.avatarThumb&&e.jsx("img",{className:"absolute z-10 top-0 left-0 w-full h-full object-cover",src:s.original.avatarThumb,width:200,height:200,alt:s.original.name}),e.jsx(y.user,{className:"text-gray-300",width:48,height:48})]})},{id:"name",accessorKey:"name",header:"ФИО",size:240,cell:({row:s})=>e.jsxs(W,{className:"flex leading-none",to:V(U.Users.Show,{id:s.original.id}),children:[s.original.surname," ",s.original.name," ",s.original.patronymic]}),enableColumnFilter:!!i.name,meta:{renderFilter:()=>e.jsx(M,{placeholder:"Искать...",value:i.name||"",onChange:s=>o(t=>({...t,name:s})),onInput:s=>o(t=>({...t,name:s.target.value}))})}},{id:"sex",accessorKey:"sex",header:"Пол",size:64,cell:({row:s})=>s.original.sex==="male"?e.jsx(y.male,{className:"flex text-blue-600",width:20,height:20}):e.jsx(y.female,{className:"flex text-pink-600",width:20,height:20}),enableColumnFilter:!!i.sex,meta:{renderFilter:()=>e.jsx(T,{placeholder:"--Выбрать--",options:[{value:"male",label:q.male},{value:"female",label:q.female}],value:i.sex||"",onChange:s=>o(t=>({...t,sex:s}))})}},{id:"grade",accessorKey:"grade",header:"Класс",size:80,cell:({row:s})=>{const t=x==null?void 0:x.find(({id:a})=>{var l;return a===((l=s.original.student)==null?void 0:l.gradeId)});if(t)return e.jsxs(W,{className:"flex w-max text-lg font-semibold",to:V(U.Classes.Show,{id:t.id}),children:[t.level," ",t.group]})},sortingFn:(s,t)=>{var d,g;const a=((d=x==null?void 0:x.find(({id:j})=>{var b;return j===((b=s.original.student)==null?void 0:b.gradeId)}))==null?void 0:d.level.toString())||"",l=((g=x==null?void 0:x.find(({id:j})=>{var b;return j===((b=t.original.student)==null?void 0:b.gradeId)}))==null?void 0:g.level.toString())||"";return a.localeCompare(l)},enableColumnFilter:!!i.grade,meta:{renderFilter:()=>e.jsx(T,{placeholder:"--Выбрать--",options:(x||[]).map(s=>({value:s.id.toString(),label:`${s.level} ${s.group}`})),value:i.grade||"",onChange:s=>o(t=>({...t,grade:s}))})}},{id:"role",accessorKey:"role",header:"Позиция",size:130,cell:({row:s})=>e.jsx("span",{className:"flex max-w-max text-center bg-blue-200 text-primary rounded-full text-sm py-1 px-2 leading-none",children:J[s.original.role]}),enableColumnFilter:!!i.role,meta:{renderFilter:()=>e.jsx(T,{placeholder:"--Выбрать--",options:ue.map(s=>({value:s,label:J[s]})),value:i.role||"",onChange:s=>o(t=>({...t,role:s}))})}},{id:"phoneNumbers",accessorKey:"phoneNumbers",header:"Телефоны",size:140,cell:({row:s})=>{var t;return s.original.phoneNumbers&&e.jsx("div",{className:"flex flex-col",children:(t=s.original.phoneNumbers)==null?void 0:t.map(a=>e.jsxs("a",{className:"font-medium min-w-max",href:`tel:+${a.code}${a.numbers}`,children:["+",`${a.code} ${a.numbers}`]},a.numbers))})},enableColumnFilter:!!i.phone,meta:{renderFilter:()=>e.jsx(M,{placeholder:"Искать...",value:i.phone||"",onInput:s=>o(t=>({...t,phone:s.target.value})),onChange:s=>o(t=>({...t,phone:s}))})}},{id:"whatsapp",accessorKey:"whatsapp",header:"WhatsApp",size:140,cell:({row:s})=>s.original.whatsapp&&e.jsx("div",{className:"flex flex-col",children:e.jsxs("a",{className:"font-medium min-w-max",href:`https://wa.me/+${s.original.whatsapp.code}${s.original.whatsapp.numbers}`,target:"_blank",children:["+",`${s.original.whatsapp.code} ${s.original.whatsapp.numbers}`]},s.original.whatsapp.numbers)}),enableColumnFilter:!!i.whatsapp,meta:{renderFilter:()=>e.jsx(M,{placeholder:"Искать...",value:i.whatsapp||"",onInput:s=>o(t=>({...t,whatsapp:s.target.value})),onChange:s=>o(t=>({...t,whatsapp:s}))})}},{id:"email",accessorKey:"email",header:"Электронная почта",size:180,cell:({row:s})=>s.original.email&&e.jsx("a",{className:"text-blue-500 font-normal",href:`mailto:${s.original.email}`,children:s.original.email}),enableColumnFilter:!!i.email,meta:{renderFilter:()=>e.jsx(M,{placeholder:"Искать...",value:i.email||"",onInput:s=>o(t=>({...t,email:s.target.value})),onChange:s=>o(t=>({...t,email:s}))})}},{id:"login",accessorKey:"login",header:"Логин",size:220,enableColumnFilter:!!i.login,meta:{renderFilter:()=>e.jsx(M,{placeholder:"Искать...",value:i.login||"",onInput:s=>o(t=>({...t,login:s.target.value})),onChange:s=>o(t=>({...t,login:s}))})}},{id:"password",accessorKey:"password",header:"Пароль",size:220,enableColumnFilter:!!i.password,cell:({row:s})=>e.jsx(we,{string:s.original.password??"",children:"Скопировать"}),meta:{renderFilter:()=>e.jsx(M,{value:i.password||"",onInput:s=>o(t=>({...t,password:s.target.value})),onChange:s=>o(t=>({...t,password:s}))})}},{id:"birthDate",accessorKey:"birthDate",header:"Дата рождения",size:140,cell:({row:s})=>s.original.birthDate&&K(s.original.birthDate).format("DD MMM YYYY")},{id:"address",accessorKey:"address",header:"Адрес",size:280,enableColumnFilter:!!((S=i.address)!=null&&S.physicalAddress||(z=i.address)!=null&&z.region),cell:({row:s})=>s.original.address&&e.jsxs("div",{className:"leading-[1.1]",children:[s.original.address.region!=="За пределами города"&&"район ",s.original.address.region,", ",s.original.address.physicalAddress]}),sortingFn:(s,t)=>{const a=s.original.address?`${s.original.address.region}, ${s.original.address.physicalAddress}`:"",l=t.original.address?`${t.original.address.region}, ${t.original.address.physicalAddress}`:"";return a.localeCompare(l)},meta:{renderFilter:()=>{var s,t;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(M,{placeholder:"Искать...",value:((s=i.address)==null?void 0:s.physicalAddress)||"",onInput:a=>o(l=>{var d;return{...l,address:{physicalAddress:a.target.value,region:((d=l.address)==null?void 0:d.region)||""}}}),onChange:a=>o(l=>{var d;return{...l,address:{physicalAddress:a,region:((d=l.address)==null?void 0:d.region)||""}}})}),e.jsx(T,{placeholder:"--Район--",options:ge.map(a=>({value:a,label:a})),value:((t=i.address)==null?void 0:t.region)||"",onChange:a=>o(l=>{var d;return{...l,address:{physicalAddress:((d=l.address)==null?void 0:d.physicalAddress)||"",region:a}}})})]})}}},{id:"nationality",accessorKey:"nationality",header:"Национальность",size:160,enableColumnFilter:!!i.nationality,cell:({row:s})=>{var t;return(t=u==null?void 0:u.find(a=>a.id===s.original.nationalityId))==null?void 0:t.name},sortingFn:(s,t)=>{var d,g;const a=((d=u==null?void 0:u.find(({id:j})=>j===s.original.nationalityId))==null?void 0:d.name)||"",l=((g=u==null?void 0:u.find(({id:j})=>j===t.original.nationalityId))==null?void 0:g.name)||"";return a.localeCompare(l)},meta:{renderFilter:()=>e.jsx(T,{placeholder:"--Выбрать--",options:(u||[]).map(s=>({value:s.id.toString(),label:s.name})),value:i.nationality||"",onChange:s=>o(t=>({...t,nationality:s}))})}},{id:"profession",accessorKey:"profession",header:"Сфера деятельности",size:200,enableColumnFilter:!!i.professionId,cell:({row:s})=>{var t,a;return m&&((t=s.original.parent)==null?void 0:t.professionId)&&((a=m.find(({id:l})=>{var d;return l===((d=s.original.parent)==null?void 0:d.professionId)}))==null?void 0:a.name)},sortingFn:(s,t)=>{var d,g;const a=((d=m==null?void 0:m.find(({id:j})=>{var b;return j===((b=s.original.parent)==null?void 0:b.professionId)}))==null?void 0:d.name)||"",l=((g=m==null?void 0:m.find(({id:j})=>{var b;return j===((b=t.original.parent)==null?void 0:b.professionId)}))==null?void 0:g.name)||"";return a.localeCompare(l)},meta:{renderFilter:()=>e.jsx("div",{className:"flex flex-col gap-2",children:e.jsx(T,{options:(m||[]).map(s=>({value:s.id.toString(),label:s.name})),value:i.professionId||"",onChange:s=>o(t=>({...t,professionId:s}))})})}},{id:"blockedAt",accessorKey:"blockedAt",header:"Блокировка",size:160,cell:({row:s})=>s.original.blockedAt?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"mb-1",variant:"danger",onClick:I(s.original.id,!1),children:"Разблокировать"}),e.jsxs("span",{className:"flex text-sm leading-none text-danger",children:["Заблокирован с ",e.jsx("br",{})," ",K(s.original.blockedAt).format("DD MMMM YYYY HH:mm")]})]}):e.jsx(_,{variant:"light",onClick:I(s.original.id,!0),children:"Заблокировать"})},{id:"socialLinks",accessorKey:"socialLinks",header:"Социальные сети",size:148,cell:({row:s})=>{var t,a,l,d,g,j,b;return e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[((t=s.original.socialLink)==null?void 0:t.facebook)&&e.jsx("a",{className:"flex shadow-md rounded-full transition-all duration-150 hover:shadow-none",href:s.original.socialLink.facebook,target:"_blank",children:e.jsx(y.facebook,{width:24,height:24})}),((a=s.original.socialLink)==null?void 0:a.instagram)&&e.jsx("a",{className:"flex shadow-md rounded-full transition-all duration-150 hover:shadow-none",href:(l=s.original.socialLink)==null?void 0:l.instagram,target:"_blank",children:e.jsx(y.instagram,{width:24,height:24})}),((d=s.original.socialLink)==null?void 0:d.telegram)&&e.jsx("a",{className:"flex shadow-md rounded-full transition-all duration-150 hover:shadow-none",href:(g=s.original.socialLink)==null?void 0:g.telegram,target:"_blank",children:e.jsx(y.telegram,{width:24,height:24})}),((j=s.original.socialLink)==null?void 0:j.odnoklassniki)&&e.jsx("a",{className:"flex shadow-md rounded-full transition-all duration-150 hover:shadow-none",href:(b=s.original.socialLink)==null?void 0:b.odnoklassniki,target:"_blank",children:e.jsx(y.odnoklassniki,{width:24,height:24})})]})}}];return e.jsxs("main",{className:"flex flex-col gap-y-1 py-2",children:[e.jsxs("h1",{className:"title",children:["Пользователи (",v==null?void 0:v.length,")"]}),v?e.jsx(Pe,{data:be(v,i),columns:D,searchValue:i.name,onSearchInput:s=>o(t=>({...t,name:s.target.value})),sortingState:[{id:"name",desc:!1}],onExport:(s,t)=>pe(s,t,{grades:x,nationalities:u,professions:m}),actions:e.jsx(_,{className:"max-h-7",icon:"add",variant:"success",href:U.Users.Create,children:e.jsx("span",{className:"sr-only md:not-sr-only",children:"Добавить"})})}):e.jsx(re,{className:"w-8 h-8"})]})}export{Qe as default};
