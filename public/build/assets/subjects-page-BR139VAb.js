import{a as u,j as e,x as N,y as m,z as v,B as D,u as f,r as d,i as F,C as w,S as C}from"./main-DS_fTM3x.js";import{g as E,a as T}from"./subjects-selector-CI-ZzRFN.js";import{D as k}from"./data-table-zL--92Lc.js";import{B as o}from"./button-CnelchTr.js";import{M as A}from"./modal-UnTQi1d1.js";import{T as b}from"./text-field-Hdj74HJO.js";import{F as x,a as p}from"./formik.esm-D39z9BFi.js";import{c as S,a as g}from"./index.esm-BP8rPnyb.js";import"./preload-helper-BfFHrpNk.js";import"./icons-8R8i3bGk.js";import"./use-dropdown-BCuJy840.js";import"./index-D2fuQSE9.js";import"./cleanable-BuAv4VuV.js";import"./index.browser-OxPLOBIU.js";const O=S().shape({name:g().required("Обязательное поле.")});function V({dto:l,setDTO:a}){const t=u(),r={name:l.name},i=async(s,c)=>{c.setSubmitting(!0),await t(N({name:s.name,onSuccess:()=>{m.success("Предмет успешно добавлен."),a(null)},onValidationError:n=>c.setErrors({...n.errors}),onFail:n=>m.success(n)})),c.setSubmitting(!1)};return e.jsx(x,{initialValues:r,validationSchema:O,onSubmit:i,children:({isSubmitting:s})=>e.jsxs(p,{children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[e.jsx("h3",{className:"title",children:"Добавление предмета"}),e.jsx(o,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>a(null),children:e.jsx("span",{className:"sr-only",children:"Отмена"})})]}),e.jsx(b,{className:"mb-4",name:"name",label:"Название предмета",required:!0}),e.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:e.jsx(o,{className:"justify-center min-w-[92px]",type:"submit",icon:"edit",disabled:s,loading:s,variant:"success",children:"Добавить"})})]})})}const q=S().shape({name:g().required("Обязательное поле.")});function z({dto:l,setDTO:a}){const t=u(),r={id:l.id,name:l.name},i=async(s,c)=>{c.setSubmitting(!0),await t(v({dto:s,onSuccess:()=>{m.success("Предмет успешно обновлен."),a(null)},onValidationError:n=>c.setErrors({...n.errors}),onFail:n=>m.success(n)})),c.setSubmitting(!1)};return e.jsx(x,{initialValues:r,validationSchema:q,onSubmit:i,children:({isSubmitting:s})=>e.jsxs(p,{children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[e.jsx("h3",{className:"title",children:"Редактирование предмета"}),e.jsx(o,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>a(null),children:e.jsx("span",{className:"sr-only",children:"Отмена"})})]}),e.jsx(b,{className:"mb-4",name:"name",label:"Название предмета",required:!0}),e.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:e.jsx(o,{className:"justify-center min-w-[92px]",type:"submit",icon:"edit",disabled:s,loading:s,variant:"success",children:"Сохранить"})})]})})}function B({dto:l,setDTO:a}){const t=u(),r=async(i,s)=>{s.setSubmitting(!0),await t(D({id:l,onSuccess:()=>{m.success("Предмет успешно удален."),a(null)}})),s.setSubmitting(!1)};return e.jsx(x,{initialValues:{},onSubmit:r,children:({isSubmitting:i})=>e.jsxs(p,{children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[e.jsx("h3",{className:"title",children:"Удаление предмета"}),e.jsx(o,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>a(null),children:e.jsx("span",{className:"sr-only",children:"Отмена"})})]}),e.jsx("p",{children:"Вы уверены что хотите удалить этот предмет?"}),e.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:e.jsx(o,{className:"justify-center min-w-[92px]",type:"submit",icon:"edit",disabled:i,loading:i,variant:"success",children:"Удалить"})})]})})}function Y(){const l=u(),a=f(E),t=f(T),[r,i]=d.useState(null),[s,c]=d.useState(null),[n,h]=d.useState(null);d.useEffect(()=>{a==F.Idle&&l(w())},[l,a]);const y=[{id:"name",accessorKey:"name",header:"Название",size:1686},{id:"actions",accessorKey:"actions",header:"Действия",enableSorting:!1,size:120,cell:({row:j})=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(o,{icon:"edit",variant:"warning",onClick:()=>c({id:j.original.id,name:j.original.name}),children:e.jsx("span",{className:"sr-only",children:"Редактировать"})}),e.jsx(o,{icon:"delete",variant:"danger",onClick:()=>h(j.original.id),children:e.jsx("span",{className:"sr-only",children:"Удалить"})})]})}];return e.jsxs(e.Fragment,{children:[e.jsxs("main",{className:"py-2",children:[e.jsxs("h1",{className:"title mb-1 px-3",children:["Предметы (",t==null?void 0:t.length,")"]}),t?e.jsx(k,{data:t,columns:y,sortingState:[{id:"name",desc:!1}],columnPinningState:{right:["actions"]},actions:e.jsx(o,{icon:"add",variant:"success",onClick:()=>i({name:""}),children:e.jsx("span",{className:"sr-only md:not-sr-only",children:"Добавить"})})}):e.jsx(C,{className:"w-8 h-8"})]}),e.jsxs(A,{isOpen:!!(r||s||n),children:[r&&e.jsx(V,{dto:r,setDTO:i}),s&&e.jsx(z,{dto:s,setDTO:c}),n&&e.jsx(B,{dto:n,setDTO:h})]})]})}export{Y as default};
