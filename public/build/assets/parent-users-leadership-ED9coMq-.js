import{a as u,f as j,r as h,j as t,c as g}from"./main-AaLcc3dp.js";import{f as b,S as N}from"./leadership-BbgJzwXF.js";import{L as y}from"./layout-CnysdNHv.js";import"./preload-helper-BfFHrpNk.js";import"./users-selector-DxlwkRpS.js";import"./button-CNp4qR8S.js";import"./icons-Dmjc42BA.js";import"./users-DUqPc0QS.js";import"./grades-selector-hlDu_ePV.js";import"./nationalities-selector-DeQUVfWI.js";import"./description-list-jOjvK5nk.js";function M(){const x=u(),o=j(),[c,p]=h.useState();h.useEffect(()=>{!c&&o.id&&x(b({studentId:+o.id,onSuccess:s=>p(s)}))},[c,x,o.id]);const f=h.useMemo(()=>{if(c){const s={};return c.marks.forEach(e=>{s[e.studentId]||(s[e.studentId]=[]),e.score1&&s[e.studentId].push(e.score1),e.score2&&s[e.studentId].push(e.score2)}),c.users.map(e=>{var i,d;const r=c.grades.find(({id:a})=>{var l;return a===(((l=e.student)==null?void 0:l.gradeId)||0)}),n=(i=s[e.id])==null?void 0:i.reduce((a,l)=>a+=N[l],0);return{id:e.id,avatar:e.avatarThumb,gradeId:((d=e.student)==null?void 0:d.gradeId)||"",name:`${e.surname} ${e.name} ${e.patronymic??""}`,grade:r?`${r==null?void 0:r.level} "${r==null?void 0:r.group}"`:"",score:n}}).sort((e,r)=>{const n=e.score,i=r.score,d=n==null,a=i==null;return d&&!a?1:!d&&a?-1:d&&a?0:i-n})}},[c]);return t.jsx(y,{children:t.jsxs("table",{className:"flex flex-col bg-white shadow rounded border",children:[t.jsx("thead",{className:"sticky top-0 z-10 flex bg-[#efefef] font-medium shadow py-1 rounded-t",children:t.jsxs("tr",{className:"grid grid-cols-[40px_1fr_8fr_2fr_2fr] w-full",children:[t.jsx("th",{children:"№"}),t.jsx("th",{children:"Фото"}),t.jsx("th",{className:"text-start",children:"ФИО"}),t.jsx("th",{children:"Класс"}),t.jsx("th",{children:"Ранг"})]})}),t.jsx("tbody",{className:"relative z-0",children:f==null?void 0:f.map((s,m)=>t.jsxs("tr",{className:g("grid grid-cols-[40px_1fr_8fr_2fr_2fr] w-full py-1",m%2&&"bg-gray-50"),children:[t.jsxs("td",{className:"flex items-center justify-center",children:[m+1,"."]}),t.jsx("td",{className:"flex items-center justify-center",children:t.jsx("div",{className:"relative z-10 w-12 lg:mb-0",children:t.jsx("div",{children:t.jsx("img",{className:"block w-full h-full rounded-full object-cover border-[2px] border-white",src:s.avatar||"/images/avatar.png",width:144,height:144,alt:s.name})})})}),t.jsx("td",{className:"flex items-center",children:s.name}),t.jsx("td",{className:"flex items-center justify-center text-lg font-medium",children:s.grade}),t.jsx("td",{className:"flex items-center justify-center text-xl font-semibold text-blue-700",children:s.score})]},s.id))})]})})}export{M as default};
