import{u as c,a as S,r as A,i as x,n as b,v,j as n,S as w,L as g,X as h,A as p}from"./main-C3zapZtd.js";import{D as y}from"./data-table-C_fhXAN-.js";import{g as I,a as N}from"./grades-selector-DA-FmHwH.js";import{g as U,a as G}from"./users-selector-DxsZfUin.js";import"./preload-helper-BfFHrpNk.js";import"./icons-CmdP5zNp.js";import"./use-dropdown-idH_Ahq5.js";import"./index-dlLad1ED.js";import"./button-k6U4pBlW.js";function R(){const f=c(I),u=c(U),o=c(N),e=c(G),d=S();A.useEffect(()=>{f==x.Idle&&d(b()),u==x.Idle&&d(v())},[d,f,u]);const j=[{id:"name",accessorKey:"name",header:"Класс",size:88,cell:({row:a})=>n.jsxs(g,{className:"text-lg font-semibold flex items-center w-full justify-center",to:h(p.Classes.Show,{id:a.original.id}),children:[a.original.level," ",n.jsx("sup",{children:'"'}),a.original.group,n.jsx("sup",{children:'"'})]}),sortingFn:(a,t)=>{const s=a.original.level,r=t.original.level;return s<r?-1:s>r?1:0}},{id:"teacher",accessorKey:"teacher",header:"Руководитель",size:320,cell:({row:a})=>{const t=e==null?void 0:e.find(({id:s})=>s===a.original.teacherId);if(t)return n.jsxs(g,{className:"block leading-[1.2]",to:h(p.Users.Show,{id:t.id}),children:[t.surname," ",t.name," ",t.patronymic]})},sortingFn:(a,t)=>{var l,i;const s=((l=e==null?void 0:e.find(({id:m})=>m===a.original.teacherId))==null?void 0:l.surname)||"",r=((i=e==null?void 0:e.find(({id:m})=>m===t.original.teacherId))==null?void 0:i.surname)||"";return s.localeCompare(r)}},{id:"students",accessorKey:"students",header:"Ученики",size:240,cell:({row:a})=>n.jsx("div",{className:"flex flex-wrap gap-1 p-1",children:e==null?void 0:e.filter(t=>{var s;return((s=t.student)==null?void 0:s.gradeId)===a.original.id}).map(t=>n.jsxs(g,{className:"py-1 px-2 border rounded bg-gray-100 hover:bg-blue-50 min-w-max",to:h(p.Users.Show,{id:t.id}),children:[t.surname," ",t.name]},t.id))}),sortingFn:(a,t)=>{const s=(e==null?void 0:e.filter(l=>{var i;return((i=l.student)==null?void 0:i.gradeId)===a.original.id}).length)||0,r=(e==null?void 0:e.filter(l=>{var i;return((i=l.student)==null?void 0:i.gradeId)===t.original.id}).length)||0;return s<r?-1:s>r?1:0},meta:{columnClass:"!min-w-none !w-full !max-w-none"}}];return n.jsxs("main",{className:"pt-4 pb-40",children:[n.jsx("header",{className:"flex justify-between px-3 items-end mb-1",children:n.jsxs("h1",{className:"title",children:["Классы (",o==null?void 0:o.length,")"]})}),o?n.jsx(y,{data:o,columns:j,sortingState:[{id:"name",desc:!1}]}):n.jsx(w,{className:"w-8 h-8"})]})}export{R as default};
