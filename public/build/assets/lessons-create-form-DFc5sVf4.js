import{a as x,u as n,t as f,j as e,at as g,y as l}from"./main-D1eUXBUZ.js";import{c as v,e as y}from"./index.esm-CFqL8ZUg.js";import{B as m}from"./button-BL-nMFYt.js";import{C as N}from"./checkbox-C7w7uuBV.js";import{S as d}from"./select-field-BxJ7FR9w.js";import{a as S}from"./users-selector-DIBafTd9.js";import{F as _,a as F}from"./formik.esm-CBfpT2PV.js";import{a as C}from"./subjects-selector-DCiFtbND.js";import"./preload-helper-BfFHrpNk.js";import"./icons-BPzoWE67.js";import"./cleanable-5YjDg63i.js";import"./use-dropdown-BiAoVFmT.js";import"./index.browser-OxPLOBIU.js";const Y=v().shape({subject_id:y().required("Выберите урок.").moreThan(0,"Выберите урок.")});function z({week:p,dto:t,setDTO:i,setLessons:u}){const j=x(),o=n(S),c=n(C),b={date:f(t.date).format("YYYY-MM-DD"),hour:t.hour,grade_id:t.grade_id,subject_id:t.subject_id},h=async(r,s)=>{s.setSubmitting(!0),await j(g({week:p,dto:r,onSuccess:a=>{l.success("Расписание успешно добавлено."),i(void 0),u(a)},onValidationError:a=>s.setErrors({...a.errors}),onFail:a=>l.success(a)})),s.setSubmitting(!1)};return e.jsx(_,{initialValues:b,validationSchema:Y,onSubmit:h,children:({isSubmitting:r})=>e.jsxs(F,{children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[e.jsx("h3",{className:"title",children:"Добавление занятия"}),e.jsx(m,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>i(void 0),children:e.jsx("span",{className:"sr-only",children:"Отмена"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 mb-4",children:[c&&e.jsx(d,{name:"subject_id",label:"Урок",searchable:!0,options:c.map(s=>({value:s.id,label:s.name}))}),o&&e.jsx(d,{name:"teacher_id",label:"Преподователь",searchable:!0,options:o.filter(s=>s.role==="teacher").map(s=>({value:s.id,label:`${s.name} ${s.surname}`}))}),e.jsx(N,{className:"col-span-2",name:"all",label:"Добавить везде"})]}),e.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:e.jsx(m,{className:"justify-center min-w-[92px]",type:"submit",icon:"add",disabled:r,loading:r,variant:"success",children:"Добавить"})})]})})}export{z as default};
