import{u,j as s,_ as b,y as d,$ as S,a0 as v,a as D,r as m,i as F,z as P,S as w}from"./main-D1X-5qeh.js";import{D as E}from"./data-table-Nl3BCqN7.js";import{B as l}from"./button-BxcCnYcJ.js";import{M as T}from"./modal-COah0HVy.js";import{g as C}from"./professions-selector-Lr4nX4_U.js";import{T as f}from"./text-field-D3e8nZd6.js";import{F as p,a as j}from"./formik.esm-CEA5_Xoc.js";import{c as g,a as y}from"./index.esm-tVQjNZt4.js";import"./preload-helper-DPi8upcZ.js";import"./icons-Cwm3zsc5.js";import"./use-dropdown-BjzLPdm1.js";import"./cleanable-BYiEZa8s.js";import"./index.browser-OxPLOBIU.js";const k=g().shape({name:y().required("Обязательное поле.")});function A({dto:c,setDTO:e}){const r=u(),o={name:c.name},n=async(a,i)=>{i.setSubmitting(!0),await r(b({name:a.name,onSuccess:()=>{d.success("Сфера деятельности добавлен."),e(null)},onValidationError:t=>i.setErrors({...t.errors}),onFail:t=>d.success(t)})),i.setSubmitting(!1)};return s.jsx(p,{initialValues:o,validationSchema:k,onSubmit:n,children:({isSubmitting:a})=>s.jsxs(j,{children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[s.jsx("h3",{className:"title",children:"Добавление"}),s.jsx(l,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>e(null),children:s.jsx("span",{className:"sr-only",children:"Отмена"})})]}),s.jsx(f,{className:"mb-4",name:"name",label:"Сфера деятельности",required:!0}),s.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:s.jsx(l,{className:"justify-center min-w-[92px]",type:"submit",icon:"edit",disabled:a,loading:a,variant:"success",children:"Добавить"})})]})})}const O=g().shape({name:y().required("Обязательное поле.")});function V({dto:c,setDTO:e}){const r=u(),o={id:c.id,name:c.name},n=async(a,i)=>{i.setSubmitting(!0),await r(S({dto:a,onSuccess:()=>{d.success("Сфера деятельности обновлен."),e(null)},onValidationError:t=>i.setErrors({...t.errors}),onFail:t=>d.success(t)})),i.setSubmitting(!1)};return s.jsx(p,{initialValues:o,validationSchema:O,onSubmit:n,children:({isSubmitting:a})=>s.jsxs(j,{children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[s.jsx("h3",{className:"title",children:"Редактирование"}),s.jsx(l,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>e(null),children:s.jsx("span",{className:"sr-only",children:"Отмена"})})]}),s.jsx(f,{className:"mb-4",name:"name",label:"Сфера деятельности",required:!0}),s.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:s.jsx(l,{className:"justify-center min-w-[92px]",type:"submit",icon:"edit",disabled:a,loading:a,variant:"success",children:"Сохранить"})})]})})}function q({dto:c,setDTO:e}){const r=u(),o=async(n,a)=>{a.setSubmitting(!0),await r(v({id:c,onSuccess:()=>{d.success("Сфера деятельности удалена."),e(null)}})),a.setSubmitting(!1)};return s.jsx(p,{initialValues:{},onSubmit:o,children:({isSubmitting:n})=>s.jsxs(j,{children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[s.jsx("h3",{className:"title",children:"Удаление"}),s.jsx(l,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>e(null),children:s.jsx("span",{className:"sr-only",children:"Отмена"})})]}),s.jsx("p",{children:"Вы уверены что хотите удалить?"}),s.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:s.jsx(l,{className:"justify-center min-w-[92px]",type:"submit",icon:"edit",disabled:n,loading:n,variant:"success",children:"Удалить"})})]})})}function U(){var h;const c=u(),e=D(C),[r,o]=m.useState(null),[n,a]=m.useState(null),[i,t]=m.useState(null);m.useEffect(()=>{!e.data&&!e.isFetching&&c(F())},[c,e.data,e.isFetching]);const N=[{id:"name",accessorKey:"name",header:"Название",size:1686},{id:"actions",accessorKey:"actions",header:"Действия",enableSorting:!1,size:120,cell:({row:x})=>s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(l,{icon:"edit",variant:"warning",onClick:()=>a({id:x.original.id,name:x.original.name}),children:s.jsx("span",{className:"sr-only",children:"Редактировать"})}),s.jsx(l,{icon:"delete",variant:"danger",onClick:()=>t(x.original.id),children:s.jsx("span",{className:"sr-only",children:"Удалить"})})]})}];return s.jsxs(P,{children:[s.jsxs("main",{className:"py-2",children:[s.jsxs("h1",{className:"title mb-1 px-3",children:["Сфера деятельности (",(h=e.data)==null?void 0:h.length,")"]}),e.data?s.jsx(E,{data:e.data,columns:N,sortingState:[{id:"name",desc:!1}],columnPinningState:{right:["actions"]},actions:s.jsx(l,{icon:"add",variant:"success",onClick:()=>o({name:""}),children:s.jsx("span",{className:"sr-only md:not-sr-only",children:"Добавить"})})}):s.jsx(w,{className:"w-8 h-8"})]}),s.jsxs(T,{isOpen:!!(r||n||i),children:[r&&s.jsx(A,{dto:r,setDTO:o}),n&&s.jsx(V,{dto:n,setDTO:a}),i&&s.jsx(q,{dto:i,setDTO:t})]})]})}export{U as default};
