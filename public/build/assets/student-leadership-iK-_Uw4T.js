import{a as p,u as j,g,r as f,j as e,S as N,c as b,L as y,X as v,A as w}from"./main-BqixXxem.js";import{f as S,S as A}from"./leadership-DzR-uJNP.js";import"./preload-helper-BfFHrpNk.js";function $(){const h=p(),x=j(g),[a,u]=f.useState();f.useEffect(()=>{a||h(S({onSuccess:t=>u(t)}))},[a,h]);const m=f.useMemo(()=>{if(a){const t={};return a.marks.forEach(s=>{t[s.studentId]||(t[s.studentId]=[]),s.score1&&t[s.studentId].push(s.score1),s.score2&&t[s.studentId].push(s.score2)}),a.users.map(s=>{var l,i;const r=a.grades.find(({id:c})=>{var n;return c===(((n=s.student)==null?void 0:n.gradeId)||0)}),d=(l=t[s.id])==null?void 0:l.reduce((c,n)=>c+=A[n],0);return{id:s.id,avatar:s.avatarThumb,gradeId:((i=s.student)==null?void 0:i.gradeId)||"",name:`${s.surname} ${s.name} ${s.patronymic??""}`,grade:r?`${r==null?void 0:r.level} "${r==null?void 0:r.group}"`:"",score:d}}).sort((s,r)=>{const d=s.score,l=r.score,i=d==null,c=l==null;return i&&!c?1:!i&&c?-1:i&&c?0:l-d})}},[a]);return!a||!m||!x?e.jsx(N,{className:"w-4 h-4 mt-4"}):e.jsxs("main",{className:"py-2 flex flex-col gap-2 pb-40",children:[e.jsx("h1",{className:"title px-3",children:"Мой класс"}),e.jsxs("table",{className:"flex flex-col bg-white shadow rounded border",children:[e.jsx("thead",{className:"sticky top-0 z-10 flex bg-[#efefef] font-medium shadow py-1 rounded-t",children:e.jsxs("tr",{className:"grid grid-cols-[40px_1fr_8fr_2fr_2fr] w-full",children:[e.jsx("th",{children:"№"}),e.jsx("th",{children:"Фото"}),e.jsx("th",{className:"text-start",children:"ФИО"}),e.jsx("th",{children:"Класс"}),e.jsx("th",{children:"Ранг"})]})}),e.jsx("tbody",{className:"relative z-0",children:m.map((t,o)=>e.jsxs("tr",{className:b("grid grid-cols-[40px_1fr_8fr_2fr_2fr] w-full py-1",o%2&&"bg-gray-50"),children:[e.jsxs("td",{className:"flex items-center justify-center",children:[o+1,"."]}),e.jsx("td",{className:"flex items-center justify-center",children:e.jsx("div",{className:"relative z-10 w-12 lg:mb-0",children:e.jsx("div",{children:e.jsx("img",{className:"block w-full h-full rounded-full object-cover border-[2px] border-white",src:t.avatar||"/images/avatar.png",width:144,height:144,alt:t.name})})})}),e.jsx("td",{className:"flex items-center text-lg",children:e.jsx(y,{className:"text-blue-600",to:v(w.Users.Show,{id:t.id}),children:t.name})}),e.jsx("td",{className:"flex items-center justify-center text-lg font-medium",children:t.grade}),e.jsx("td",{className:"flex items-center justify-center text-xl font-semibold text-blue-700",children:t.score})]},t.id))})]})]})}export{$ as default};
