import{u as d,j as e,ac as m,y as l,r as u}from"./main-DLHcp_34.js";import{I as f}from"./icons-OdLsuZAu.js";import{B as x}from"./button-Bb1-8EaV.js";import{T as p}from"./text-field-JQl_BxZn.js";import{F as h,a as g}from"./formik.esm-D9UO8hfm.js";import"./preload-helper-DPi8upcZ.js";import"./cleanable-Ndm0y06g.js";import"./index.browser-OxPLOBIU.js";function w({dto:i,onSuccess:n}){const o=d(),a=i,c=async(t,r)=>{r.setSubmitting(!0),await o(m({dto:t,onSuccess:s=>{n&&n(s),l.success("Данные успешно сохранены.")},onValidationError:s=>r.setErrors({...s.errors}),onFail:s=>l.success(s)})),r.setSubmitting(!1)};return e.jsx(h,{initialValues:a,onSubmit:c,children:({isSubmitting:t})=>e.jsxs(g,{className:"flex flex-col px-2 gap-2",children:[e.jsx(p,{className:"grow",name:"score",label:"Оценка",autoFocus:!0}),e.jsx("div",{className:"flex items-center justify-end gap-2 -mt-1",children:e.jsx(x,{className:"!h-8 bg-transparent !text-success shadow-none hover:!bg-transparent",type:"submit",disabled:t,loading:t,variant:"success",children:"Сохранить"})})]})})}function k({studentName:i,position:n,dto:o,onClose:a,onSuccess:c}){const t=u.useRef(null);return u.useEffect(()=>{if(t.current){t.current.style.top=`${n.top}px`,t.current.style.left=`${n.left}px`;const s=t.current.getBoundingClientRect();s.right>window.innerWidth&&(t.current.style.transform=`translateX(-${s.right-window.innerWidth+32}px)`),s.bottom>window.innerHeight&&(t.current.style.top="auto",t.current.style.bottom="16px")}const r=s=>{t.current&&!t.current.contains(s.target)&&a()};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[a,n.left,n.top]),e.jsxs("div",{ref:t,className:"fixed left z-30 min-w-52 max-w-52 flex-col py-1 bg-white rounded border shadow transform font-normal",children:[e.jsxs("div",{className:"flex justify-between items-center pl-2 pr-1",children:[e.jsx("h3",{className:"text-sm leading-none text-gray-400",children:i}),e.jsx("button",{className:"border rounded p-1 text-danger",type:"button",onClick:a,children:e.jsx(f.close,{width:10,height:10})})]}),e.jsx("hr",{className:"my-1"}),e.jsx(w,{dto:o,onSuccess:r=>{c(r),a()}})]})}export{k as default};
