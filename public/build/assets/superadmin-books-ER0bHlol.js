import{a as T,u as o,r as n,i as S,ao as O,a7 as C,j as e,S as A,L as N}from"./main-C3zapZtd.js";import{D as b}from"./data-table-C_fhXAN-.js";import{B as p}from"./button-k6U4pBlW.js";import{M as z}from"./modal-Dx9j0xvg.js";import{b as I,g as K,c as E,a as F}from"./books-selector-BCbTauf5.js";import{B as v,a as _,b as L}from"./books-delete-form-DdtpN5ex.js";import{A as M}from"./books-Bhzd4aEF.js";import"./preload-helper-BfFHrpNk.js";import"./icons-CmdP5zNp.js";import"./use-dropdown-idH_Ahq5.js";import"./index-dlLad1ED.js";import"./content-field-2RzNRsd5.js";import"./cleanable-xJmsbn0p.js";import"./formik.esm-ShEui-VR.js";import"./select-field-BtHvfVcq.js";import"./index.browser-OxPLOBIU.js";import"./text-field-DVRwjedT.js";import"./index.esm-CBOWuRvE.js";function ae(){const r=T(),u=o(I),h=o(K),a=o(E),t=o(F),[l,x]=n.useState(null),[c,f]=n.useState(null),[d,k]=n.useState(null);n.useEffect(()=>{u===S.Idle&&r(O()),h===S.Idle&&r(C())},[u,h,r]);const B=[{id:"title",accessorKey:"title",header:"Название",size:360},{id:"category",accessorKey:"category",header:"Категория",size:360,cell:({row:s})=>{var i;return(i=t==null?void 0:t.find(({id:m})=>+m==+s.original.categoryId))==null?void 0:i.title},sortingFn:(s,i)=>{var y,j;const m=((y=t==null?void 0:t.find(({id:g})=>+g==+s.original.categoryId))==null?void 0:y.title)||"",D=((j=t==null?void 0:t.find(({id:g})=>+g==+i.original.categoryId))==null?void 0:j.title)||"";return m.localeCompare(D)}},{id:"access",accessorKey:"access",header:"Доступность",size:200,cell:({row:s})=>M[s.original.access]},{id:"lang",accessorKey:"lang",header:"Язык",size:160},{id:"link",accessorKey:"link",header:"Ссылка",size:420,cell:({row:s})=>e.jsx(N,{className:"text-blue-500",to:s.original.link,target:"_blank",children:s.original.link})},{id:"actions",accessorKey:"actions",header:"Действия",enableSorting:!1,size:120,cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{icon:"edit",variant:"warning",onClick:()=>f({id:s.original.id,category_id:+s.original.categoryId,title:s.original.title,access:s.original.access,lang:s.original.lang,link:s.original.link,description:s.original.description}),children:e.jsx("span",{className:"sr-only",children:"Редактировать"})}),e.jsx(p,{icon:"delete",variant:"danger",onClick:()=>k(s.original.id),children:e.jsx("span",{className:"sr-only",children:"Удалить"})})]})}];return e.jsxs(e.Fragment,{children:[e.jsxs("main",{className:"py-2",children:[e.jsxs("h1",{className:"title mb-1 px-3",children:["Книги (",a==null?void 0:a.length,")"]}),a?e.jsx(b,{data:a,columns:B,sortingState:[{id:"title",desc:!1}],columnPinningState:{right:["actions"]},actions:e.jsx(p,{icon:"add",variant:"success",onClick:()=>x({category_id:0,title:"",access:"all",lang:""}),children:e.jsx("span",{className:"sr-only md:not-sr-only",children:"Добавить"})})}):e.jsx(A,{className:"w-8 h-8"})]}),e.jsxs(z,{isOpen:!!(l||c||d),children:[l&&e.jsx(v,{dto:l,setDTO:x}),c&&e.jsx(_,{dto:c,setDTO:f}),d&&e.jsx(L,{dto:d,setDTO:k})]})]})}export{ae as default};
