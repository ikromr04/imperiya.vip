import{u as c,w as $,F as g}from"./FileSaver.min-BwkF0A4M.js";import{R as i}from"./users-DUqPc0QS.js";const _=s=>{const t=c.book_new(),r=c.json_to_sheet([{Параметр:"Класс",Значение:s.classInfo.class},{Параметр:"Количество учеников",Значение:`${s.classInfo.totalStudents} (девочек ${s.classInfo.girls.length} / мальчиков ${s.classInfo.boys.length})`},...i.map(o=>({Параметр:o,Значение:`(девочек ${s.classInfo.girls.filter(n=>{var e;return((e=n.address)==null?void 0:e.region)===o}).length} / мальчиков ${s.classInfo.boys.filter(n=>{var e;return((e=n.address)==null?void 0:e.region)===o}).length})`})),{Параметр:"Отличники",Значение:`${s.classInfo.excellent.count} (${s.classInfo.excellent.percent}%)`},{Параметр:"Четвёрочники",Значение:`${s.classInfo.good.count} (${s.classInfo.good.percent}%)`},{Параметр:"Троечники",Значение:`${s.classInfo.average.count} (${s.classInfo.average.percent}%)`},{Параметр:"Двоечники",Значение:`${s.classInfo.poor.count} (${s.classInfo.poor.percent}%)`},{Параметр:"Без оценок",Значение:`${s.classInfo.noGrades.count} (${s.classInfo.noGrades.percent}%)`}]);c.book_append_sheet(t,r,"Общая информация");const p={excellent:"Отличники",good:"Четвёрочники",average:"Троечники",poor:"Двоечники",noGrades:"Без оценок"};for(const[o,n]of Object.entries(p)){const e=s.students[o],a=e.length?e.map(l=>({ФИО:l.name,"Средний балл":l.average,"Округлённая оценка":l.rounded})):[{Сообщение:"Нет учеников"}],I=c.json_to_sheet(a);c.book_append_sheet(t,I,n)}const f=$(t,{bookType:"xlsx",type:"array"});g.saveAs(new Blob([f],{type:"application/octet-stream"}),`${s.classInfo.class}_Класс_Отчет.xlsx`)};export{_ as e};
