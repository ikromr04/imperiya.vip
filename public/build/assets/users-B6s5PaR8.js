import{t as I}from"./main-Cy12n2Tw.js";import{u as b,w as C,F as N}from"./FileSaver.min-elO0v-ZG.js";import{S as _,b as u}from"./users-DUqPc0QS.js";const L=(d,a)=>(d=d.filter(e=>{var n,p,r,$,D,s,t,m,c,g,i,w,f,o,h,x,S,l,y,Y,k;return`${e.surname} ${e.name} ${e.patronymic??""}`.toLowerCase().includes((a.name||"").toLowerCase())&&(a.sex?e.sex===a.sex:!0)&&(a.grade?((p=(n=e.student)==null?void 0:n.gradeId)==null?void 0:p.toString())===a.grade:!0)&&(a.role?e.role===a.role:!0)&&(a.phone?(r=e.phoneNumbers)==null?void 0:r.some(A=>`+${A.code} ${A.numbers}`.includes(a.phone||"")):!0)&&(a.whatsapp?`+${($=e.whatsapp)==null?void 0:$.code} ${(D=e.whatsapp)==null?void 0:D.numbers}`.includes(a.whatsapp):!0)&&(a.email?(s=e.email)==null?void 0:s.includes(a.email||""):!0)&&(a.login?(t=e.login)==null?void 0:t.includes(a.login||""):!0)&&(a.password?(m=e.password)==null?void 0:m.includes(a.password||""):!0)&&((c=a.birthDate)!=null&&c.day?a.birthDate.day===I(e.birthDate).format("D").toString().padStart(2,"0"):!0)&&((g=a.birthDate)!=null&&g.month?a.birthDate.month===I(e.birthDate).format("M").toString().padStart(2,"0"):!0)&&((i=a.birthDate)!=null&&i.year?a.birthDate.year.toString()===I(e.birthDate).format("YYYY").toString():!0)&&((w=a.address)!=null&&w.physicalAddress?(h=`район ${(f=e.address)==null?void 0:f.region}, ${(o=e.address)==null?void 0:o.physicalAddress}`.toLowerCase())==null?void 0:h.includes(a.address.physicalAddress.toLowerCase()||""):!0)&&((x=a.address)!=null&&x.region?((S=e.address)==null?void 0:S.region)===a.address.region:!0)&&(a.nationality?((l=e.nationalityId)==null?void 0:l.toString())===a.nationality:!0)&&(a.professionId?((y=e.parent)==null?void 0:y.professionId.toString())===a.professionId:!0)&&(a.talents?(k=(Y=e.student)==null?void 0:Y.talents)==null?void 0:k.includes(a.talents||""):!0)}),d),M=(d,a)=>{const e=d.map(r=>r.id),n=e.indexOf(a);if(n===-1)throw new Error("Current user ID not found in the list of users");const p=(n+1)%e.length;return e[p]},j=(d,a)=>{const e=d.map(r=>r.id),n=e.indexOf(a);if(n===-1)throw new Error("Current user ID not found in the list of users");const p=(n-1+e.length)%e.length;return e[p]},F=(d,a,e)=>{const n=d.map(s=>{var m,c,g,i,w,f;let t={};if(a.name!==!1&&(t={...t,ФИО:`${s.surname} ${s.name} ${s.patronymic??""}`}),a.sex!==!1&&(t={...t,Пол:_[s.sex]}),a.grade!==!1){const o=(m=e.grades)==null?void 0:m.find(({id:h})=>{var x;return h===((x=s.student)==null?void 0:x.gradeId)});t={...t,Класс:o?`${o==null?void 0:o.level} ${o==null?void 0:o.group}`:""}}return a.role!==!1&&(t={...t,Позиция:u[s.role]}),a.phoneNumbers!==!1&&(t={...t,Телефоны:(c=s.phoneNumbers)==null?void 0:c.map(o=>`+${o.code} ${o.numbers}`).join(`, 
`)}),a.whatsapp!==!1&&(t={...t,WhatsApp:s.whatsapp?`+${s.whatsapp.code} ${s.whatsapp.numbers}`:""}),a.email!==!1&&(t={...t,"Электронная почта":s.email??""}),a.login!==!1&&(t={...t,Логин:s.login}),a.password!==!1&&(t={...t,Пароль:s.password}),a.birthDate!==!1&&(t={...t,"Дата рождения":s.birthDate?I(s.birthDate).format("DD MMM YYYY"):""}),a.address!==!1&&(t={...t,Адрес:s.address?`${s.address.region!=="За пределами города"&&"район "} ${s.address.region}, ${s.address.physicalAddress}`:""}),a.nationality!==!1&&(t={...t,Национальность:((i=(g=e.nationalities)==null?void 0:g.find(o=>o.id===s.nationalityId))==null?void 0:i.name)??""}),a.profession!==!1&&(t={...t,"Сфера деятельности":((f=(w=e.professions)==null?void 0:w.find(({id:o})=>{var h;return o===((h=s.parent)==null?void 0:h.professionId)}))==null?void 0:f.name)??""}),t}),p=b.json_to_sheet(n),r=b.book_new();b.book_append_sheet(r,p,"Sheet1");const $=C(r,{type:"array",bookType:"xlsx"}),D=new Blob([$],{type:"application/octet-stream"});N.saveAs(D,"usersDataSheet.xlsx")};export{M as a,F as e,L as f,j as g};
