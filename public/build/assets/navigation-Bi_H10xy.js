import{r as m,a as w,j as e,S as y,c as o,aa as A,y as b,ab as U,u as j,i as S,n as I,X as r,A as i,a8 as h}from"./main-ConWnhM4.js";import{I as d}from"./icons-DmwnT1ee.js";import{B as u}from"./button-CKVFwUw_.js";import{b as k}from"./users-DUqPc0QS.js";import{g as D,a as F}from"./grades-selector-C8NliX7u.js";import{g as C,a as L}from"./users-BrrXfeOM.js";import{u as $}from"./use-dropdown-dRrjbPrc.js";function z({user:t}){const a=w(),{ref:x,isOpen:c,setIsOpen:n}=$(),[s,l]=m.useState(!1),g=async N=>{l(!0);const f=new FormData;f.append("avatar",N.target.files[0]),await a(A({formData:f,id:t.id,onValidationError:p=>b.error(p.message),onFail:p=>b.error(p),onSuccess:()=>n(!1)})),l(!1)},v=async()=>{l(!0),await a(U({id:t.id})),l(!1)};return e.jsxs("div",{ref:x,className:"relative z-10 w-36 mb-2 lg:mb-0",children:[e.jsxs(u,{className:"relative min-w-36 max-w-36 min-h-36 max-h-36 !p-0",variant:"text",onClick:()=>n(!c),children:[e.jsx("img",{className:"block w-full h-full rounded-full object-cover border-[2px] border-white",src:t.avatarThumb||"/images/avatar.png",width:144,height:144,alt:t.name}),s&&e.jsx(y,{className:"absolute w-full h-full"})]}),e.jsx("div",{className:o("absolute top-full left-1/2 w-full border rounded-md py-1 bg-white shadow-sm text-sm min-w-max transform -translate-x-1/2 transition-all duration-150 text-gray-500",c?"visible opacity-100":"invisible opacity-0"),children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsxs("label",{className:"flex items-center gap-2 w-full h-8 transition-all duration-150 hover:bg-gray-100 px-3 cursor-pointer",children:[e.jsx("input",{className:"sr-only",type:"file",accept:".png, .jpg, .jpeg",onChange:g}),t.avatarThumb?e.jsxs(e.Fragment,{children:[e.jsx(d.edit,{width:14,height:14})," Изменить фото"]}):e.jsxs(e.Fragment,{children:[e.jsx(d.add,{width:14,height:14})," Добавить фото"]})]})}),t.avatarThumb&&t.avatar&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:e.jsxs("a",{className:"flex w-full gap-2 items-center h-8 transition-all duration-150 hover:bg-gray-100 px-3",href:t.avatar,target:"_blank",children:[e.jsx(d.visibility,{width:14,height:14})," Просмотреть"]})}),e.jsx("li",{children:e.jsxs("button",{className:"flex w-full gap-2 items-center h-8 transition-all duration-150 hover:bg-gray-100 px-3",type:"button",onClick:v,children:[e.jsx(d.delete,{width:14,height:14})," Удалить фото"]})})]})]})})]})}const E=m.memo(z);function R({users:t,user:a}){const x=w(),c=j(D),n=j(F),s=n==null?void 0:n.find(({id:l})=>{var g;return l===((g=a.student)==null?void 0:g.gradeId)});return m.useEffect(()=>{c===S.Idle&&x(I())},[x,c]),e.jsxs("header",{className:"relative z-10 lg:flex lg:items-top lg:gap-4",children:[e.jsx(E,{user:a}),e.jsxs("div",{className:"lg:grow lg:mt-20",children:[e.jsxs("h1",{className:"title mb-1",children:[a.surname," ",a.name]}),e.jsxs("span",{className:"flex max-w-max text-center bg-blue-200 text-primary rounded-full text-sm py-1 px-2 leading-none",children:[k[a.role]," ",s&&`${s==null?void 0:s.level} ${s.group}`]})]}),e.jsxs("div",{className:"absolute top-28 right-0 z-10 flex items-center gap-1 lg:static lg:top-0 lg:items-start lg:mt-20",children:[e.jsxs(u,{variant:"light",href:r(i.Users.Show,{id:C(t,a.id)}),children:[e.jsx(d.previous,{width:14,height:14}),e.jsx("span",{className:"sr-only md:not-sr-only",children:"Предыдущий"})]}),e.jsxs(u,{variant:"light",href:r(i.Users.Show,{id:L(t,a.id)}),children:[e.jsx("span",{className:"sr-only md:not-sr-only",children:"Следующий"}),e.jsx(d.next,{width:14,height:14})]})]})]})}const _=m.memo(R);function B({user:t}){return e.jsxs("div",{className:"relative",children:[e.jsxs("ul",{className:"flex items-center font-medium text-slate-500 overflow-scroll no-scrollbar py-4 pl-2 -ml-2 pr-7",children:[e.jsx("li",{children:e.jsx(h,{className:({isActive:a})=>o("flex items-center h-7 px-2 transition-all duration-150 border border-transparent min-w-max",a&&"rounded shadow bg-white border-gray-200"),to:r(i.Users.Show,{id:t.id}),end:!0,children:"Профиль"})}),t.role==="teacher"&&e.jsx("li",{children:e.jsx(h,{className:({isActive:a})=>o("flex items-center h-7 px-2 transition-all duration-150 border border-transparent min-w-max",a&&"rounded shadow bg-white border-gray-200"),to:r(i.Users.Lessons,{id:t.id}),children:"Расписание занятий"})}),t.role==="student"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:e.jsx(h,{className:({isActive:a})=>o("flex items-center h-7 px-2 transition-all duration-150 border border-transparent min-w-max",a&&"rounded shadow bg-white border-gray-200"),to:r(i.Users.Lessons,{id:t.id}),children:"Расписание занятий"})}),e.jsx("li",{children:e.jsx(h,{className:({isActive:a})=>o("flex items-center h-7 px-2 transition-all duration-150 border border-transparent min-w-max",a&&"rounded shadow bg-white border-gray-200"),to:r(i.Users.Diary,{id:t.id}),children:"Дневник"})}),e.jsx("li",{children:e.jsx(h,{className:({isActive:a})=>o("flex items-center h-7 px-2 transition-all duration-150 border border-transparent min-w-max",a&&"rounded shadow bg-white border-gray-200"),to:r(i.Users.Ratings,{id:t.id}),children:"Оценки за четверть"})})]})]}),e.jsx("div",{className:"absolute top-0 right-0 z-10 min-w-6 h-full pointer-events-none bg-gradient-to-l from-gray-100 to-transparent"})]})}const q=m.memo(B);export{_ as H,q as N};
