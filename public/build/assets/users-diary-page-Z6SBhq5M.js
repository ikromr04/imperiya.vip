import{u as S,a as n,r as x,h as N,x as k,w as L,z as U,B as P,j as s,S as E,q as e,c as b,e as _,m as C,t as R,N as G,A as H}from"./main-Dw1yuUwf.js";import h from"./not-found-page-CWStc02z.js";import{H as W,L as q}from"./lesson-hour-Bm3tHKLi.js";import{I as g}from"./icons-D1xy210t.js";import{g as F,c as D}from"./index-C4_IihsQ.js";import{g as T,a as B}from"./subjects-selector-CFx4eaql.js";import{g as v,a as A}from"./users-selector-DnYDMv9p.js";import{D as O}from"./diary-item-kuyaqvx0.js";import{L as $}from"./layout-BODneOIk.js";import{g as J,a as K}from"./grades-selector-7JnXScQQ.js";import"./preload-helper-DPi8upcZ.js";import"./button-CZ8BjX0E.js";import"./marks-KWTxiGgr.js";import"./users-DUqPc0QS.js";import"./nationalities-selector-3uynH7pm.js";import"./description-list-CKcNa6Qp.js";function Q({grade:c,studentId:d}){const o=S(),f=n(v),p=n(T),m=n(A),a=n(B),[i,l]=x.useState(null),[w,z]=x.useState(null),[j,y]=x.useState(0),u=F(j),Y=x.useRef(null);x.useEffect(()=>{f===N.Idle&&o(k()),p===N.Idle&&o(L()),i||o(U({week:j,gradeId:c.id,onSuccess:t=>{l(t),o(P({lessons:t.map(({id:r})=>r),onSuccess:r=>z(r)}))}}))},[o,c.id,i,d,p,f,j]);const M=t=>{if(Y.current){const{scrollLeft:r}=t.currentTarget;Y.current.querySelectorAll(".sync-scroll").forEach(I=>{I.scrollLeft=r})}};return!i||!m?s.jsx(E,{className:"w-8 h-8"}):s.jsxs("div",{className:"rounded-md shadow border pb-1 bg-[linear-gradient(to_bottom,white_0%,white_50%,#f3f4f6_50%,#f3f4f6_100%)]",children:[s.jsxs("table",{ref:Y,className:"flex flex-col w-full",children:[s.jsx("caption",{className:"text-left p-2 pl-4 border-b",children:s.jsxs("div",{className:"flex items-baseline gap-1 text-blue-700",children:[s.jsx(g.calendar,{className:"relative top-[1px]",height:16}),D(e(u[0]).format("MMMM - YYYY")),e(u[0]).format("M")!==e(u[5]).format("M")&&` - ${D(e(u[5]).format("MMMM"))}`]})}),s.jsx("thead",{className:"sticky top-0 z-20 bg-gray-100 shadow overflow-x-auto no-scrollbar sync-scroll",onScroll:M,children:s.jsxs("tr",{children:[s.jsx("th",{className:"min-w-7 w-7 max-w-7 sticky left-0 z-10 bg-gray-100"}),s.jsx("th",{className:"min-w-7 w-7 max-w-7 sticky left-7 z-10 bg-gray-100"}),s.jsx("th",{className:"min-w-20 w-20 max-w-20"}),s.jsx("th",{className:"p-2 min-w-[260px] w-[260px] max-w-[260px] text-start",children:"Предмет"}),s.jsx("th",{className:"p-2 min-w-[120px] w-[120px] max-w-[120px] text-start",children:"Посещаемость"}),s.jsx("th",{className:"p-2 min-w-20 w-20 max-w-20 text-center font-bold",children:"Оценка"}),s.jsx("th",{className:"p-2 min-w-[360px] w-[360px] max-w-[360px] text-start",children:"Комментарий"}),s.jsx("th",{className:"p-2 min-w-[288px] w-[288px] max-w-[288px] text-start",children:"Домашнее задание"}),s.jsx("th",{className:"p-2 min-w-[288px] w-[288px] max-w-[288px] text-start",children:"Тема урока"}),s.jsx("th",{className:"p-2 min-w-[320px] w-[320px] max-w-[320px] text-start",children:"Педагог"})]})}),s.jsx("tbody",{className:"overflow-x-auto no-scrollbar sync-scroll bg-white",onScroll:M,children:u.map(t=>s.jsxs(x.Fragment,{children:[s.jsx("tr",{className:b("border-b",e(t).format("YYYY-MM-DD")===e().format("YYYY-MM-DD")&&"bg-green-50"),children:s.jsx("td",{className:b("min-w-7 w-7 max-w-7 sticky left-0 z-10",e(t).format("YYYY-MM-DD")===e().format("YYYY-MM-DD")?"bg-green-50":"bg-white"),rowSpan:9,children:s.jsx("div",{className:"absolute left-1/2 top-1/2 flex gap-2 min-w-max text-blue-700 -translate-x-1/2 -translate-y-1/2 -rotate-90",children:D(t.format("dddd - DD"))})})}),Object.keys(W).map(r=>s.jsxs("tr",{className:b("min-h-10 h-10 border-b",e(t).format("YYYY-MM-DD")===e().format("YYYY-MM-DD")&&"bg-green-50"),children:[s.jsx("td",{className:"min-w-7 w-7 max-w-7 text-center font-semibold sticky left-7 z-10",children:s.jsx("div",{className:b("absolute left-0 top-0 w-full h-full border-r border-l flex justify-center items-center",e(t).format("YYYY-MM-DD")===e().format("YYYY-MM-DD")?"bg-green-50":"bg-white"),children:r})}),s.jsx("td",{className:"min-w-20 w-20 max-w-20 text-sm",children:s.jsx(q,{hour:+r})}),a&&m&&w&&s.jsx(O,{date:e(t).format(),hour:+r,lessons:i,subjects:a,marks:w,users:m,studentId:d})]},r))]},t.format("YYYY-MM-DD")))}),s.jsx("tfoot",{className:"sticky bottom-[48px] z-10 overflow-x-auto bg-white styled-scrollbar mb-[-1px] sync-scroll",onScroll:M,children:s.jsxs("tr",{children:[s.jsx("td",{className:"p-0 min-w-7 w-7 max-w-7 sticky left-0 z-10 bg-gray-100"}),s.jsx("td",{className:"p-0 min-w-7 w-7 max-w-7 sticky left-7 z-10 bg-gray-100"}),s.jsx("td",{className:"p-0 min-w-20 w-20 max-w-20"}),s.jsx("td",{className:"p-0 border-t min-w-[260px] w-[260px] max-w-[260px] text-start"}),s.jsx("td",{className:"p-0 border-t min-w-[120px] w-[120px] max-w-[120px] text-start"}),s.jsx("td",{className:"p-0 border-t min-w-20 w-20 max-w-20 text-center font-bold"}),s.jsx("td",{className:"p-0 border-t min-w-[360px] w-[360px] max-w-[360px] text-start"}),s.jsx("td",{className:"p-0 border-t min-w-[288px] w-[288px] max-w-[288px] text-start"}),s.jsx("td",{className:"p-0 border-t min-w-[288px] w-[288px] max-w-[288px] text-start"}),s.jsx("td",{className:"p-0 border-t min-w-[320px] w-[320px] max-w-[320px] text-start"})]})})]}),s.jsx("div",{className:"sticky bottom-0 z-10 p-2 border-t bg-gray-100",children:s.jsxs("div",{className:"flex w-max ml-auto gap-4",children:[s.jsxs("button",{className:"flex justify-center items-center gap-x-2 h-8 border-transparent rounded-md border transform disabled:opacity-50 disabled:pointer-events-none",onClick:()=>{y(t=>t-1),l(null)},children:[s.jsx(g.previous,{width:7}),s.jsx("span",{className:"sr-only md:not-sr-only",children:"Предыдущая неделя"})]}),j!==0&&s.jsxs("button",{className:"flex justify-center items-center h-8 rounded-md",onClick:()=>{y(0),l(null)},children:[s.jsx(g.currentWeek,{width:16,height:16}),s.jsx("span",{className:"sr-only",children:"Текущая неделя"})]}),s.jsxs("button",{className:"flex justify-center items-center gap-x-2 h-8 border-transparent rounded-md border transform disabled:opacity-50 disabled:pointer-events-none",onClick:()=>{y(t=>t+1),l(null)},children:[s.jsx("span",{className:"sr-only md:not-sr-only",children:"Следующая неделя"}),s.jsx(g.next,{width:7})]})]})})]})}function V(){const c=_(),d=S(),o=n(v),f=n(J),p=n(A),m=n(K),a=(p==null?void 0:p.find(l=>l.id===+(c.id||0)))||null,i=m==null?void 0:m.find(({id:l})=>{var w;return l===((w=a==null?void 0:a.student)==null?void 0:w.gradeId)});return x.useEffect(()=>{o===N.Idle&&d(k()),f===N.Idle&&d(C())},[d,f,o]),s.jsx($,{children:i&&a&&s.jsx(Q,{grade:i,studentId:a==null?void 0:a.id})})}const X={superadmin:()=>s.jsx(h,{}),admin:()=>s.jsx(h,{}),director:()=>s.jsx(h,{}),teacher:()=>s.jsx(h,{}),parent:()=>s.jsx(V,{}),student:()=>s.jsx(h,{})};function ws(){const c=n(R);return c?X[c.role]():s.jsx(G,{to:H.Auth.Login})}export{ws as default};
