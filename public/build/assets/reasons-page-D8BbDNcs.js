import{a as u,j as s,a0 as S,y as d,a1 as v,a2 as D,u as f,r as m,i as R,a3 as F,S as w}from"./main-yWuhb5Gt.js";import{D as E}from"./data-table-TnC6bnKf.js";import{B as o}from"./button-BKPH64SX.js";import{M as T}from"./modal-6Vkj86FB.js";import{g as C,a as k}from"./reasons-selector-DQyAIHnE.js";import{T as g}from"./text-field-DEwqXaiJ.js";import{F as x,a as j}from"./formik.esm-BRAvGE8Y.js";import{c as y,a as N}from"./index.esm-DO-o8iAu.js";import"./preload-helper-BfFHrpNk.js";import"./icons-CK1IQmfH.js";import"./use-dropdown-D2SgKNhE.js";import"./index-bMPnDbnu.js";import"./cleanable-DQsDMRP2.js";import"./index.browser-OxPLOBIU.js";const A=y().shape({description:N().required("Обязательное поле.")});function O({dto:r,setDTO:i}){const a=u(),l={description:r.description},n=async(e,c)=>{c.setSubmitting(!0),await a(S({description:e.description,onSuccess:()=>{d.success("Причина успешно добавлена."),i(null)},onValidationError:t=>c.setErrors({...t.errors}),onFail:t=>d.success(t)})),c.setSubmitting(!1)};return s.jsx(x,{initialValues:l,validationSchema:A,onSubmit:n,children:({isSubmitting:e})=>s.jsxs(j,{children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[s.jsx("h3",{className:"title",children:"Добавление причины"}),s.jsx(o,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>i(null),children:s.jsx("span",{className:"sr-only",children:"Отмена"})})]}),s.jsx(g,{className:"mb-4",name:"description",label:"Описание",required:!0}),s.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:s.jsx(o,{className:"justify-center min-w-[92px]",type:"submit",icon:"edit",disabled:e,loading:e,variant:"success",children:"Добавить"})})]})})}const V=y().shape({description:N().required("Обязательное поле.")});function q({dto:r,setDTO:i}){const a=u(),l={id:r.id,description:r.description},n=async(e,c)=>{c.setSubmitting(!0),await a(v({dto:e,onSuccess:()=>{d.success("Причина успешно обновлена."),i(null)},onValidationError:t=>c.setErrors({...t.errors}),onFail:t=>d.success(t)})),c.setSubmitting(!1)};return s.jsx(x,{initialValues:l,validationSchema:V,onSubmit:n,children:({isSubmitting:e})=>s.jsxs(j,{children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[s.jsx("h3",{className:"title",children:"Редактирование"}),s.jsx(o,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>i(null),children:s.jsx("span",{className:"sr-only",children:"Отмена"})})]}),s.jsx(g,{className:"mb-4",name:"description",label:"Описание",required:!0}),s.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:s.jsx(o,{className:"justify-center min-w-[92px]",type:"submit",icon:"edit",disabled:e,loading:e,variant:"success",children:"Сохранить"})})]})})}function $({dto:r,setDTO:i}){const a=u(),l=async(n,e)=>{e.setSubmitting(!0),await a(D({id:r,onSuccess:()=>{d.success("Причина успешно удалена."),i(null)}})),e.setSubmitting(!1)};return s.jsx(x,{initialValues:{},onSubmit:l,children:({isSubmitting:n})=>s.jsxs(j,{children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[s.jsx("h3",{className:"title",children:"Удалить причину"}),s.jsx(o,{className:"ml-auto",type:"reset",variant:"danger",icon:"close",onClick:()=>i(null),children:s.jsx("span",{className:"sr-only",children:"Отмена"})})]}),s.jsx("p",{children:"Вы уверены что хотите удалить?"}),s.jsx("div",{className:"flex items-center justify-end gap-2 sm:col-span-2",children:s.jsx(o,{className:"justify-center min-w-[92px]",type:"submit",icon:"edit",disabled:n,loading:n,variant:"success",children:"Удалить"})})]})})}function Y(){const r=u(),i=f(C),a=f(k),[l,n]=m.useState(null),[e,c]=m.useState(null),[t,h]=m.useState(null);m.useEffect(()=>{i===R.Idle&&r(F())},[r,i]);const b=[{id:"description",accessorKey:"description",header:"Описание",size:1686},{id:"actions",accessorKey:"actions",header:"Действия",enableSorting:!1,size:120,cell:({row:p})=>s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(o,{icon:"edit",variant:"warning",onClick:()=>c({id:p.original.id,description:p.original.description}),children:s.jsx("span",{className:"sr-only",children:"Редактировать"})}),s.jsx(o,{icon:"delete",variant:"danger",onClick:()=>h(p.original.id),children:s.jsx("span",{className:"sr-only",children:"Удалить"})})]})}];return s.jsxs(s.Fragment,{children:[s.jsxs("main",{className:"py-2",children:[s.jsxs("h1",{className:"title mb-1 px-3",children:["Причины (",a==null?void 0:a.length,")"]}),a?s.jsx(E,{data:a,columns:b,sortingState:[{id:"description",desc:!1}],columnPinningState:{right:["actions"]},actions:s.jsx(o,{icon:"add",variant:"success",onClick:()=>n({description:""}),children:s.jsx("span",{className:"sr-only md:not-sr-only",children:"Добавить"})})}):s.jsx(w,{className:"w-8 h-8"})]}),s.jsxs(T,{isOpen:!!(l||e||t),children:[l&&s.jsx(O,{dto:l,setDTO:n}),e&&s.jsx(q,{dto:e,setDTO:c}),t&&s.jsx($,{dto:t,setDTO:h})]})]})}export{Y as default};
